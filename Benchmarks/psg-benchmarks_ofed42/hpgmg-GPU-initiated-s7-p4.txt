./run.sh 4 1 1 1 7 8
[hsw212:30183] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[18596] [3] MP INFO mp_init() using IB device: mlx5_0 
[18596] [3] MP INFO mp_init() HCA dev: mlx5_0
[30210] [0] MP INFO mp_init() using IB device: mlx5_0 
[30210] [0] MP INFO mp_init() HCA dev: mlx5_0
[19333] [1] MP INFO mp_init() using IB device: mlx5_0 
[19333] [1] MP INFO mp_init() HCA dev: mlx5_0
[18706] [2] MP INFO mp_init() using IB device: mlx5_0 
[18706] [2] MP INFO mp_init() HCA dev: mlx5_0
[18596] GDS WARN  gds_create_qp() using peer res_domain 0xea9cb0 for QP
[18596] GDS WARN  gds_create_qp() using peer res_domain 0xea9cb0 for QP
[30210] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1ba0 for QP
[30210] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1ba0 for QP
[30210] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc66b0 for QP
[30210] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc66b0 for QP
[18596] GDS WARN  gds_create_qp() using peer res_domain 0x29c5d60 for QP
[18596] GDS WARN  gds_create_qp() using peer res_domain 0x29c5d60 for QP
[18706] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe694250 for QP
[18706] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe694250 for QP
[19333] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2b4d50 for QP
[19333] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2b4d50 for QP
[18596] GDS WARN  gds_create_qp() using peer res_domain 0x29ef8e0 for QP
[18596] GDS WARN  gds_create_qp() using peer res_domain 0x29ef8e0 for QP
[18706] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bc920 for QP
[18706] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bc920 for QP
[19333] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cd4820 for QP
[19333] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cd4820 for QP
[30210] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0670 for QP
[30210] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0670 for QP
[19333] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cfe7f0 for QP
[19333] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cfe7f0 for QP
[18706] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e64e0 for QP
[18706] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e64e0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.106652 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.624817 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.015597 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002885 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000915 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000160 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000127 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000663 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000145 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001322 seconds)
  Building MPI subcommunicator for level 2... done (0.000048 seconds)
  Building MPI subcommunicator for level 3... done (0.000031 seconds)
  Building MPI subcommunicator for level 4... done (0.000032 seconds)
  Building MPI subcommunicator for level 5... done (0.000029 seconds)
  Building MPI subcommunicator for level 6... done (0.000034 seconds)
  Building MPI subcommunicator for level 7... done (0.000035 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.127761 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036568 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012882 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010777 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003258 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002416 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.226687 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129073 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128370 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126964 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128245 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128399 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128709 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129271 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127924 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128078 seconds)

WARMUP TIME: 1.382478


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129585 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130688 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128152 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129090 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127440 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128668 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130613 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127498 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128130 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130245 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128591 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127934 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132093 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128008 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127905 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129020 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127953 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129852 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130357 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130125 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129244 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130690 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129083 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127185 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130618 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129879 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127072 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131132 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128737 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128169 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127891 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129156 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130129 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129539 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128799 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129474 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132517 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128069 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128597 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128108 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126703 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129490 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126463 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127489 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127907 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130508 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128060 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128181 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130082 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127947 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127691 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128484 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125991 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130460 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128706 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127568 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129440 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127293 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128675 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127915 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128309 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128277 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127676 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128157 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129963 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129103 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130382 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128327 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128126 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130871 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132159 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132448 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127742 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132725 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127214 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130149 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129276 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128675 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127715 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130542 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126990 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129468 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130910 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128786 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127629 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129727 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129059 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127391 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127607 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128986 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128898 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128503 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130361 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128168 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126911 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129686 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128176 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128066 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128542 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128679 seconds)

EXEC_TIME TIME: 12.898719


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000049     0.000096     0.000143     0.000188     0.003356     0.000647     0.000151     0.000000     0.004630
residual                      0.000009     0.000008     0.000013     0.000016     0.000456     0.000080     0.000019     0.000009     0.000609
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041455     0.000004     0.000007     0.000011     0.000032     0.000014     0.000009     0.000031     0.041563
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000115     0.000229     0.000338     0.000457     0.000617     0.000322     0.000210     0.000041     0.002329
Restriction                   0.000011     0.000014     0.000019     0.063338     0.000025     0.000584     0.000070     0.000000     0.064061
  local restriction           0.000010     0.000014     0.000018     0.001258     0.000022     0.000006     0.000003     0.000000     0.001331
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000563     0.000047     0.000000     0.000611
Interpolation                 0.000137     0.000194     0.000237     0.000549     0.000244     0.000192     0.000474     0.000000     0.002027
  local interpolation         0.000009     0.000014     0.000019     0.000330     0.000110     0.000020     0.000005     0.000000     0.000507
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000025     0.000016     0.000000     0.000041
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000013     0.000432     0.000000     0.000445
Ghost Zone Exchange           0.000920     0.001759     0.002596     0.003260     0.002622     0.001418     0.001546     0.000005     0.014126
  local exchange              0.000078     0.000156     0.000233     0.000322     0.000250     0.000093     0.000068     0.000000     0.001200
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000180     0.000079     0.000064     0.000000     0.000322
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000240     0.000100     0.000069     0.000000     0.000409
  MPI_Isend                   0.000091     0.000194     0.000313     0.000415     0.000478     0.000406     0.000733     0.000000     0.002629
  MPI_Irecv                   0.000247     0.000514     0.000824     0.001038     0.000238     0.000253     0.000168     0.000000     0.003284
  MPI_Waitall                 0.000129     0.000259     0.000388     0.000535     0.001204     0.000455     0.000410     0.000000     0.003379
MPI_collectives               0.000239     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000196     0.000435
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042879     0.002196     0.003201     0.067652     0.007133     0.003136     0.002363     0.000333     0.128892

   Total time in MGBuild      0.460344 seconds
   Total time in MGSolve      0.128910 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.128910  DOF/s=4.392e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129390 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw212:30234] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[18643] [3] MP INFO mp_init() using IB device: mlx5_0 
[18643] [3] MP INFO mp_init() HCA dev: mlx5_0
[19380] [1] MP INFO mp_init() using IB device: mlx5_0 
[19380] [1] MP INFO mp_init() HCA dev: mlx5_0
[30261] [0] MP INFO mp_init() using IB device: mlx5_0 
[30261] [0] MP INFO mp_init() HCA dev: mlx5_0
[18754] [2] MP INFO mp_init() using IB device: mlx5_0 
[18754] [2] MP INFO mp_init() HCA dev: mlx5_0
[18643] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe27c4c0 for QP
[18643] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe27c4c0 for QP
[19380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1580 for QP
[19380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1580 for QP
[30261] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1d20 for QP
[30261] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1d20 for QP
[18754] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe003970 for QP
[18754] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe003970 for QP
[18643] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ca5030 for QP
[18643] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ca5030 for QP
[19380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7080 for QP
[19380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7080 for QP
[30261] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc3490 for QP
[30261] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc3490 for QP
[18754] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe037130 for QP
[18754] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe037130 for QP
[18643] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cceff0 for QP
[18643] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cceff0 for QP
[19380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff1450 for QP
[19380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff1450 for QP
[30261] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fed050 for QP
[30261] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fed050 for QP
[18754] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe061130 for QP
[18754] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe061130 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.103492 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.638587 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.017535 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.003270 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001014 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000325 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000140 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000674 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000147 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001176 seconds)
  Building MPI subcommunicator for level 2... done (0.000045 seconds)
  Building MPI subcommunicator for level 3... done (0.000031 seconds)
  Building MPI subcommunicator for level 4... done (0.000035 seconds)
  Building MPI subcommunicator for level 5... done (0.000033 seconds)
  Building MPI subcommunicator for level 6... done (0.000029 seconds)
  Building MPI subcommunicator for level 7... done (0.000033 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.129462 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036679 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012272 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011386 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003335 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002731 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.223854 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127725 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129306 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127216 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128659 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128385 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130819 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133949 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128890 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128401 seconds)

WARMUP TIME: 1.387921


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128373 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130299 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128483 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131487 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129892 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128216 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128017 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128628 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127933 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131048 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131327 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129517 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132007 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128713 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127814 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128509 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128981 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129658 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128285 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128811 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127261 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129775 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128331 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128929 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129293 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129298 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131397 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129218 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131710 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129099 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128355 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128426 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126991 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129739 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129093 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128888 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130554 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128368 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129610 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128182 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129091 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127756 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129901 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129341 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128529 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129370 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129878 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128044 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128599 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127504 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131088 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127981 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126476 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129514 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129928 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127651 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128183 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129743 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128011 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130454 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128457 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128376 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130412 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130164 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129707 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129803 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128483 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128391 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128270 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127233 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128990 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131011 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127261 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129767 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129497 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129766 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128603 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126943 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127679 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131515 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128872 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129178 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129430 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128227 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127963 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131607 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129938 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128416 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129922 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129433 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128471 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128801 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129531 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129320 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129000 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129473 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128476 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128902 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128866 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128937 seconds)

EXEC_TIME TIME: 12.915946


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000097     0.000144     0.000192     0.003360     0.000670     0.000164     0.000000     0.004673
residual                      0.000008     0.000008     0.000012     0.000016     0.000457     0.000080     0.000019     0.000009     0.000610
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041467     0.000004     0.000007     0.000011     0.000032     0.000014     0.000012     0.000031     0.041577
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000115     0.000229     0.000341     0.000453     0.000617     0.000332     0.000213     0.000043     0.002344
Restriction                   0.000011     0.000014     0.000019     0.063383     0.000024     0.000071     0.000092     0.000000     0.063614
  local restriction           0.000010     0.000014     0.000018     0.001262     0.000022     0.000005     0.000003     0.000000     0.001334
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000016     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000051     0.000068     0.000000     0.000119
Interpolation                 0.000137     0.000193     0.000236     0.000546     0.000230     0.000203     0.000881     0.000000     0.002426
  local interpolation         0.000009     0.000014     0.000018     0.000328     0.000110     0.000019     0.000005     0.000000     0.000504
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000038     0.000016     0.000000     0.000054
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000016     0.000839     0.000000     0.000855
Ghost Zone Exchange           0.000915     0.001749     0.002598     0.003239     0.002458     0.002234     0.001054     0.000004     0.014252
  local exchange              0.000080     0.000158     0.000239     0.000327     0.000249     0.000111     0.000076     0.000000     0.001239
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000179     0.000078     0.000065     0.000000     0.000322
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000240     0.000121     0.000074     0.000000     0.000435
  MPI_Isend                   0.000092     0.000194     0.000314     0.000417     0.000389     0.001236     0.000257     0.000000     0.002898
  MPI_Irecv                   0.000241     0.000501     0.000814     0.001016     0.000240     0.000259     0.000172     0.000000     0.003244
  MPI_Waitall                 0.000131     0.000261     0.000391     0.000534     0.001128     0.000395     0.000378     0.000000     0.003218
MPI_collectives               0.000242     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000194     0.000435
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042885     0.002185     0.003205     0.067674     0.006959     0.003500     0.002321     0.000334     0.129064

   Total time in MGBuild      0.463286 seconds
   Total time in MGSolve      0.129081 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.129081  DOF/s=4.387e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128624 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw212:30290] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[18680] [3] MP INFO mp_init() using IB device: mlx5_0 
[18680] [3] MP INFO mp_init() HCA dev: mlx5_0
[19417] [1] MP INFO mp_init() using IB device: mlx5_0 
[19417] [1] MP INFO mp_init() HCA dev: mlx5_0
[30317] [0] MP INFO mp_init() using IB device: mlx5_0 
[30317] [0] MP INFO mp_init() HCA dev: mlx5_0
[18790] [2] MP INFO mp_init() using IB device: mlx5_0 
[18790] [2] MP INFO mp_init() HCA dev: mlx5_0
[18680] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1580 for QP
[18680] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1580 for QP
[19417] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1850 for QP
[19417] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1850 for QP
[30317] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4c5e60 for QP
[30317] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4c5e60 for QP
[18790] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a2030 for QP
[18790] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a2030 for QP
[18680] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7020 for QP
[18680] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7020 for QP
[19417] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7310 for QP
[19417] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7310 for QP
[30317] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0a50 for QP
[30317] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0a50 for QP
[18790] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc3740 for QP
[18790] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc3740 for QP
[18680] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0ff0 for QP
[18680] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0ff0 for QP
[19417] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff12e0 for QP
[19417] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff12e0 for QP
[30317] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1429a60 for QP
[30317] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1429a60 for QP
[18790] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fed330 for QP
[18790] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fed330 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.105464 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.610701 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.017091 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002852 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000972 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000283 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000121 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000670 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000144 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000953 seconds)
  Building MPI subcommunicator for level 2... done (0.000045 seconds)
  Building MPI subcommunicator for level 3... done (0.000031 seconds)
  Building MPI subcommunicator for level 4... done (0.000031 seconds)
  Building MPI subcommunicator for level 5... done (0.000033 seconds)
  Building MPI subcommunicator for level 6... done (0.000030 seconds)
  Building MPI subcommunicator for level 7... done (0.000034 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.129949 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036580 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012565 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010978 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003316 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002383 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.227552 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128332 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128608 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128560 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129100 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128717 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131750 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129568 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129273 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128391 seconds)

WARMUP TIME: 1.390568


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126236 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127406 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127601 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131805 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127428 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128652 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127564 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129253 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131700 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127760 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130186 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128654 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127648 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128913 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127544 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130346 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131432 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128610 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130329 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127265 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127556 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131263 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129376 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131059 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132826 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129394 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127666 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128906 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129974 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127906 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129799 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127282 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128479 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128103 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129279 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129605 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129698 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129266 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131004 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130363 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127716 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127106 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132110 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130953 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127226 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130178 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130499 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126779 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129531 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128668 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127882 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129246 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130537 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130373 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130071 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129085 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129200 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128660 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129238 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130084 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129755 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129916 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126353 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129282 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128431 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128163 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128352 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133613 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131438 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129658 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131497 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129242 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129027 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129980 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130121 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129585 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131234 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128982 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127403 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130079 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128179 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129622 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129936 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128032 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129997 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129236 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129567 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128318 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128702 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130940 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127317 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129569 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129666 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128994 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127999 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128576 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129285 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127809 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127024 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131914 seconds)

EXEC_TIME TIME: 12.930329


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000047     0.000096     0.000142     0.000191     0.003355     0.000669     0.000161     0.000000     0.004662
residual                      0.000008     0.000008     0.000012     0.000017     0.000456     0.000080     0.000019     0.000008     0.000609
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041481     0.000004     0.000007     0.000011     0.000032     0.000014     0.000012     0.000031     0.041592
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000115     0.000228     0.000337     0.000453     0.000616     0.000323     0.000215     0.000043     0.002330
Restriction                   0.000011     0.000014     0.000019     0.063392     0.000024     0.000104     0.000096     0.000000     0.063660
  local restriction           0.000010     0.000013     0.000018     0.001253     0.000022     0.000005     0.000003     0.000000     0.001325
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000084     0.000073     0.000000     0.000156
Interpolation                 0.000137     0.000191     0.000237     0.000552     0.000249     0.000191     0.000762     0.000000     0.002319
  local interpolation         0.000009     0.000014     0.000019     0.000335     0.000110     0.000019     0.000005     0.000000     0.000512
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000014     0.000016     0.000000     0.000030
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000034     0.000720     0.000000     0.000754
Ghost Zone Exchange           0.000916     0.001749     0.002576     0.003234     0.002509     0.001784     0.001712     0.000005     0.014483
  local exchange              0.000078     0.000154     0.000232     0.000324     0.000255     0.000107     0.000074     0.000000     0.001223
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000181     0.000078     0.000065     0.000000     0.000324
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000238     0.000117     0.000073     0.000000     0.000428
  MPI_Isend                   0.000092     0.000193     0.000310     0.000414     0.000655     0.000742     0.000840     0.000000     0.003245
  MPI_Irecv                   0.000243     0.000503     0.000809     0.001018     0.000243     0.000260     0.000173     0.000000     0.003249
  MPI_Waitall                 0.000128     0.000256     0.000385     0.000529     0.000904     0.000446     0.000453     0.000000     0.003102
MPI_collectives               0.000235     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000197     0.000432
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042895     0.002181     0.003179     0.067681     0.007022     0.003042     0.002871     0.000335     0.129207

   Total time in MGBuild      0.462751 seconds
   Total time in MGSolve      0.129226 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.129226  DOF/s=4.382e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129601 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw212:30339] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[18717] [3] MP INFO mp_init() using IB device: mlx5_0 
[18717] [3] MP INFO mp_init() HCA dev: mlx5_0
[18834] [2] MP INFO mp_init() using IB device: mlx5_0 
[18834] [2] MP INFO mp_init() HCA dev: mlx5_0
[19461] [1] MP INFO mp_init() using IB device: mlx5_0 
[19461] [1] MP INFO mp_init() HCA dev: mlx5_0
[30366] [0] MP INFO mp_init() using IB device: mlx5_0 
[30366] [0] MP INFO mp_init() HCA dev: mlx5_0
[18717] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe27bf40 for QP
[18717] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe27bf40 for QP
[18834] GDS WARN  gds_create_qp() using peer res_domain 0xf7ccb0 for QP
[18834] GDS WARN  gds_create_qp() using peer res_domain 0xf7ccb0 for QP
[19461] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2d6010 for QP
[19461] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2d6010 for QP
[30366] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a12e0 for QP
[30366] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a12e0 for QP
[18717] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ca3a50 for QP
[18717] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ca3a50 for QP
[18834] GDS WARN  gds_create_qp() using peer res_domain 0x2a990c0 for QP
[18834] GDS WARN  gds_create_qp() using peer res_domain 0x2a990c0 for QP
[19461] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4d33830 for QP
[19461] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4d33830 for QP
[30366] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6d90 for QP
[30366] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6d90 for QP
[18717] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ccda10 for QP
[18717] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ccda10 for QP
[18834] GDS WARN  gds_create_qp() using peer res_domain 0x2ac30c0 for QP
[18834] GDS WARN  gds_create_qp() using peer res_domain 0x2ac30c0 for QP
[19461] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4d5d7f0 for QP
[19461] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4d5d7f0 for QP
[30366] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0d60 for QP
[30366] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0d60 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.104306 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.615784 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.016571 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.003055 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000931 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000179 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000140 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000672 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000129 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000938 seconds)
  Building MPI subcommunicator for level 2... done (0.000057 seconds)
  Building MPI subcommunicator for level 3... done (0.000033 seconds)
  Building MPI subcommunicator for level 4... done (0.000031 seconds)
  Building MPI subcommunicator for level 5... done (0.000032 seconds)
  Building MPI subcommunicator for level 6... done (0.000031 seconds)
  Building MPI subcommunicator for level 7... done (0.000038 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.129797 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036603 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012284 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.012546 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003468 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002649 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.227113 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126777 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127220 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126649 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128559 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131091 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131252 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128877 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131567 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127925 seconds)

WARMUP TIME: 1.387757


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128336 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129241 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131106 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126769 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126550 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130155 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133106 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129095 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128658 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126831 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130330 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128417 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129081 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128419 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128757 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130834 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127906 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128953 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130536 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131874 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129776 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128233 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128515 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127533 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.134249 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128014 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131131 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131406 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128938 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129757 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129369 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132615 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129249 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128348 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128457 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128158 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128437 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127624 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129235 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.134399 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129413 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129902 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128393 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126471 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128463 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129075 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130283 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129012 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128285 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127560 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128016 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131204 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128016 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127390 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130073 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127725 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127691 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127396 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131036 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128595 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127893 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129031 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130685 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129627 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129870 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129525 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130343 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127600 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129287 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129892 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129049 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129169 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128682 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131828 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127646 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131619 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131434 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127530 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129097 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127133 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128780 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130081 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127262 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130174 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131933 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128762 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128244 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129587 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129470 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128110 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131332 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130455 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128529 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131270 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129507 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128329 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130037 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126411 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127761 seconds)

EXEC_TIME TIME: 12.929710


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000096     0.000142     0.000188     0.003359     0.000614     0.000151     0.000000     0.004598
residual                      0.000009     0.000008     0.000012     0.000016     0.000456     0.000078     0.000019     0.000008     0.000607
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041447     0.000004     0.000007     0.000011     0.000032     0.000012     0.000009     0.000031     0.041553
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000117     0.000230     0.000342     0.000461     0.000615     0.000302     0.000213     0.000041     0.002321
Restriction                   0.000011     0.000014     0.000020     0.063297     0.000024     0.000086     0.000089     0.000000     0.063542
  local restriction           0.000010     0.000014     0.000019     0.001267     0.000022     0.000005     0.000003     0.000000     0.001339
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000015     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000065     0.000067     0.000000     0.000132
Interpolation                 0.000137     0.000192     0.000234     0.000534     0.000232     0.000204     0.001102     0.000000     0.002636
  local interpolation         0.000009     0.000014     0.000018     0.000323     0.000109     0.000018     0.000005     0.000000     0.000497
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000018     0.000016     0.000000     0.000033
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000047     0.001060     0.000000     0.001108
Ghost Zone Exchange           0.000913     0.001744     0.002589     0.003235     0.002416     0.002292     0.001164     0.000004     0.014357
  local exchange              0.000078     0.000155     0.000234     0.000324     0.000251     0.000072     0.000067     0.000000     0.001181
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000180     0.000076     0.000061     0.000000     0.000316
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000238     0.000078     0.000068     0.000000     0.000384
  MPI_Isend                   0.000092     0.000195     0.000315     0.000418     0.000331     0.001089     0.000275     0.000000     0.002716
  MPI_Irecv                   0.000241     0.000501     0.000811     0.001018     0.000242     0.000251     0.000168     0.000000     0.003231
  MPI_Waitall                 0.000128     0.000257     0.000388     0.000528     0.001143     0.000693     0.000490     0.000000     0.003627
MPI_collectives               0.000242     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000195     0.000436
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042866     0.002179     0.003195     0.067579     0.006922     0.003482     0.002645     0.000332     0.129200

   Total time in MGBuild      0.465937 seconds
   Total time in MGSolve      0.129219 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.129219  DOF/s=4.382e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127489 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw212:30389] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[18760] [3] MP INFO mp_init() using IB device: mlx5_0 
[18760] [3] MP INFO mp_init() HCA dev: mlx5_0
[19497] [1] MP INFO mp_init() using IB device: mlx5_0 
[19497] [1] MP INFO mp_init() HCA dev: mlx5_0
[18873] [2] MP INFO mp_init() using IB device: mlx5_0 
[18873] [2] MP INFO mp_init() HCA dev: mlx5_0
[30416] [0] MP INFO mp_init() using IB device: mlx5_0 
[30416] [0] MP INFO mp_init() HCA dev: mlx5_0
[18760] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1ac0 for QP
[18760] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1ac0 for QP
[19497] GDS WARN  gds_create_qp() using peer res_domain 0xf7d210 for QP
[19497] GDS WARN  gds_create_qp() using peer res_domain 0xf7d210 for QP
[18873] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe6b4680 for QP
[18873] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe6b4680 for QP
[30416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a2260 for QP
[30416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a2260 for QP
[18760] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6640 for QP
[18760] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6640 for QP
[19497] GDS WARN  gds_create_qp() using peer res_domain 0x2a996a0 for QP
[19497] GDS WARN  gds_create_qp() using peer res_domain 0x2a996a0 for QP
[18873] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51d9110 for QP
[18873] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51d9110 for QP
[30416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6d70 for QP
[30416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6d70 for QP
[18760] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0640 for QP
[18760] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0640 for QP
[19497] GDS WARN  gds_create_qp() using peer res_domain 0x2ac3670 for QP
[19497] GDS WARN  gds_create_qp() using peer res_domain 0x2ac3670 for QP
[18873] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1403130 for QP
[18873] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1403130 for QP
[30416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0d30 for QP
[30416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0d30 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.106584 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.690601 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.017257 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002836 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000920 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000225 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000123 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000698 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000139 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001211 seconds)
  Building MPI subcommunicator for level 2... done (0.000047 seconds)
  Building MPI subcommunicator for level 3... done (0.000032 seconds)
  Building MPI subcommunicator for level 4... done (0.000030 seconds)
  Building MPI subcommunicator for level 5... done (0.000030 seconds)
  Building MPI subcommunicator for level 6... done (0.000030 seconds)
  Building MPI subcommunicator for level 7... done (0.000032 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.128403 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036115 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012710 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011956 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003336 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002426 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.228070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129920 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131738 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129714 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129439 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129324 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129707 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129907 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133174 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130112 seconds)

WARMUP TIME: 1.401857


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132492 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130326 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130876 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130013 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130276 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131073 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132403 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129448 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132944 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130880 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133512 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130478 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130870 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129931 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129847 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129972 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127920 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129281 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131626 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130894 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130946 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130934 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129942 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130400 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133635 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129283 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129886 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129812 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132642 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128357 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130104 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126858 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128022 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130138 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130929 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131757 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130414 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127786 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129937 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129805 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130935 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130475 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131386 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128174 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130578 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130033 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128639 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130258 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131388 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129736 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128160 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130437 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130435 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128195 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128176 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129399 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129101 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129167 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129551 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127455 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132810 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131991 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129141 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128742 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130628 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130246 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127904 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128665 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130502 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128665 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132920 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128790 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130036 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131976 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131672 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129688 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130400 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129367 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130416 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129955 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129516 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128760 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128949 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131983 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131949 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131434 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128181 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128079 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128564 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129448 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129287 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131939 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129997 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127193 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129250 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130403 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130283 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127802 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131660 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129029 seconds)

EXEC_TIME TIME: 13.013520


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000097     0.000142     0.000188     0.003433     0.000621     0.000163     0.000000     0.004693
residual                      0.000009     0.000008     0.000013     0.000016     0.000465     0.000076     0.000019     0.000008     0.000614
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041490     0.000004     0.000007     0.000011     0.000032     0.000013     0.000013     0.000030     0.041600
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000113     0.000224     0.000332     0.000455     0.000655     0.000343     0.000245     0.000048     0.002416
Restriction                   0.000011     0.000014     0.000020     0.063381     0.000023     0.000072     0.000081     0.000000     0.063602
  local restriction           0.000010     0.000013     0.000019     0.001260     0.000021     0.000006     0.000003     0.000000     0.001333
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000016     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000051     0.000057     0.000000     0.000108
Interpolation                 0.000137     0.000190     0.000234     0.000518     0.000259     0.000146     0.002452     0.000000     0.003936
  local interpolation         0.000009     0.000014     0.000019     0.000331     0.000111     0.000019     0.000005     0.000000     0.000508
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000010     0.000000     0.000016
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000009     0.000015     0.000000     0.000024
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000013     0.002407     0.000000     0.002420
Ghost Zone Exchange           0.000914     0.001752     0.002583     0.003230     0.002037     0.002024     0.001042     0.000004     0.013587
  local exchange              0.000078     0.000154     0.000231     0.000320     0.000267     0.000089     0.000083     0.000000     0.001221
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000196     0.000092     0.000069     0.000000     0.000357
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000256     0.000104     0.000081     0.000000     0.000441
  MPI_Isend                   0.000092     0.000195     0.000313     0.000415     0.000410     0.000958     0.000234     0.000000     0.002618
  MPI_Irecv                   0.000242     0.000504     0.000809     0.001013     0.000245     0.000253     0.000171     0.000000     0.003237
  MPI_Waitall                 0.000129     0.000259     0.000391     0.000534     0.000630     0.000494     0.000369     0.000000     0.002805
MPI_collectives               0.000241     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000189     0.000430
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042910     0.002181     0.003180     0.067637     0.006715     0.003166     0.003924     0.000329     0.130042

   Total time in MGBuild      0.462255 seconds
   Total time in MGSolve      0.130061 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.130061  DOF/s=4.354e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130599 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1
