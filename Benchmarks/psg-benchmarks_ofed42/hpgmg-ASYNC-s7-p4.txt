./run.sh 4 1 1 0 7 8
[hsw212:27465] Warning: could not find environment variable "MP_ENABLE_WARN"


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[16981] [2] MP INFO mp_init() using IB device: mlx5_0 
[16981] [2] MP INFO mp_init() HCA dev: mlx5_0
[17370] [1] MP INFO mp_init() using IB device: mlx5_0 
[17370] [1] MP INFO mp_init() HCA dev: mlx5_0
[27499] [0] MP INFO mp_init() using IB device: mlx5_0 
[27499] [0] MP INFO mp_init() HCA dev: mlx5_0
[16868] [3] MP INFO mp_init() using IB device: mlx5_0 
[16868] [3] MP INFO mp_init() HCA dev: mlx5_0
[16981] GDS WARN  gds_create_qp() using peer res_domain 0xf99ae0 for QP
[16981] GDS WARN  gds_create_qp() using peer res_domain 0xf99ae0 for QP
[17370] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe6949f0 for QP
[17370] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe6949f0 for QP
[27499] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe694640 for QP
[27499] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe694640 for QP
[16868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a15e0 for QP
[16868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a15e0 for QP
[17370] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51b81a0 for QP
[17370] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51b81a0 for QP
[16981] GDS WARN  gds_create_qp() using peer res_domain 0x2ab5ef0 for QP
[16981] GDS WARN  gds_create_qp() using peer res_domain 0x2ab5ef0 for QP
[27499] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bfe80 for QP
[27499] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bfe80 for QP
[17370] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e1d60 for QP
[17370] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e1d60 for QP
[16981] GDS WARN  gds_create_qp() using peer res_domain 0x2adfeb0 for QP
[16981] GDS WARN  gds_create_qp() using peer res_domain 0x2adfeb0 for QP
[16868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6cf0 for QP
[16868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6cf0 for QP
[27499] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e9a50 for QP
[27499] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e9a50 for QP
[16868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff08a0 for QP
[16868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff08a0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.104246 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.590383 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.018959 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002639 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000921 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000286 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000122 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000683 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000134 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001315 seconds)
  Building MPI subcommunicator for level 2... done (0.000047 seconds)
  Building MPI subcommunicator for level 3... done (0.000030 seconds)
  Building MPI subcommunicator for level 4... done (0.000033 seconds)
  Building MPI subcommunicator for level 5... done (0.000038 seconds)
  Building MPI subcommunicator for level 6... done (0.000031 seconds)
  Building MPI subcommunicator for level 7... done (0.000034 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.126507 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.035984 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012679 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010526 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003260 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002523 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.223039 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127450 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130095 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130134 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128625 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130890 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132797 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128517 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131656 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129774 seconds)

WARMUP TIME: 1.393548


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128788 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129670 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129409 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133877 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128936 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132037 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127921 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132040 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132872 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131256 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128534 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131948 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130966 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130023 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129918 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131738 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129931 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131095 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132109 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129936 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129505 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.134315 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129826 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132925 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129068 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131960 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131929 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131857 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130962 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132030 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131833 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128990 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127108 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129669 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131004 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131908 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127743 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128740 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130277 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128371 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128657 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131165 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128677 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130957 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130846 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133904 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130084 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132830 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128037 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129567 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130258 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128970 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130922 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132974 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128953 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130470 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129286 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131740 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128829 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129298 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129895 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132848 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128591 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131368 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131092 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128898 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131292 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129453 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131031 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127849 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129101 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131008 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130934 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129968 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130792 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129000 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127067 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133908 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129993 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127926 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130760 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131102 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130955 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130945 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131794 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128057 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131985 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132876 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129673 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129177 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129982 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126876 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131973 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130856 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129112 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131422 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130647 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129324 seconds)

EXEC_TIME TIME: 13.046726


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000096     0.000144     0.000190     0.003434     0.000644     0.000151     0.000000     0.004707
residual                      0.000008     0.000008     0.000012     0.000017     0.000463     0.000078     0.000018     0.000008     0.000613
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000036     0.000036
BLAS1                         0.040618     0.000004     0.000007     0.000011     0.000032     0.000014     0.000010     0.000030     0.040726
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000114     0.000222     0.000334     0.000440     0.000655     0.000338     0.000237     0.000046     0.002386
Restriction                   0.000012     0.000015     0.000021     0.061046     0.000024     0.000093     0.000068     0.000000     0.061279
  local restriction           0.000011     0.000014     0.000020     0.001253     0.000022     0.000006     0.000003     0.000000     0.001328
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000005
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000026
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000073     0.000045     0.000000     0.000118
Interpolation                 0.000178     0.000254     0.000317     0.000444     0.000238     0.001316     0.002410     0.000000     0.005157
  local interpolation         0.000009     0.000014     0.000018     0.000261     0.000112     0.000019     0.000005     0.000000     0.000439
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000010     0.000000     0.000016
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000015     0.000000     0.000027
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.001165     0.002365     0.000000     0.003530
Ghost Zone Exchange           0.001229     0.002361     0.003470     0.004499     0.001950     0.001342     0.001238     0.000004     0.016093
  local exchange              0.000061     0.000120     0.000172     0.000238     0.000268     0.000089     0.000078     0.000000     0.001026
  pack MPI buffers            0.000060     0.000123     0.000174     0.000247     0.000197     0.000089     0.000067     0.000000     0.000957
  unpack MPI buffers          0.000055     0.000111     0.000166     0.000220     0.000255     0.000106     0.000076     0.000000     0.000990
  MPI_Isend                   0.000277     0.000564     0.000861     0.001163     0.000379     0.000434     0.000164     0.000000     0.003842
  MPI_Irecv                   0.000238     0.000489     0.000793     0.001016     0.000241     0.000247     0.000166     0.000000     0.003191
  MPI_Waitall                 0.000180     0.000356     0.000533     0.000725     0.000579     0.000345     0.000653     0.000000     0.003371
MPI_collectives               0.000238     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000188     0.000426
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042404     0.002810     0.004090     0.066398     0.006614     0.003713     0.004030     0.000325     0.130383

   Total time in MGBuild      0.455772 seconds
   Total time in MGSolve      0.130402 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.130402  DOF/s=4.342e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128227 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 7 8
[hsw212:27522] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[16909] [3] MP INFO mp_init() using IB device: mlx5_0 
[16909] [3] MP INFO mp_init() HCA dev: mlx5_0
[27549] [0] MP INFO mp_init() using IB device: mlx5_0 
[27549] [0] MP INFO mp_init() HCA dev: mlx5_0
[17408] [1] MP INFO mp_init() using IB device: mlx5_0 
[17408] [1] MP INFO mp_init() HCA dev: mlx5_0
[17019] [2] MP INFO mp_init() using IB device: mlx5_0 
[17019] [2] MP INFO mp_init() HCA dev: mlx5_0
[16909] GDS WARN  gds_create_qp() using peer res_domain 0xf97a80 for QP
[16909] GDS WARN  gds_create_qp() using peer res_domain 0xf97a80 for QP
[27549] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a16a0 for QP
[27549] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a16a0 for QP
[16909] GDS WARN  gds_create_qp() using peer res_domain 0x2ab3f10 for QP
[16909] GDS WARN  gds_create_qp() using peer res_domain 0x2ab3f10 for QP
[17408] GDS WARN  gds_create_qp() using peer res_domain 0xf99330 for QP
[17408] GDS WARN  gds_create_qp() using peer res_domain 0xf99330 for QP
[17019] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a34a0 for QP
[17019] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a34a0 for QP
[27549] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7200 for QP
[27549] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc7200 for QP
[16909] GDS WARN  gds_create_qp() using peer res_domain 0x2ade2b0 for QP
[16909] GDS WARN  gds_create_qp() using peer res_domain 0x2ade2b0 for QP
[17408] GDS WARN  gds_create_qp() using peer res_domain 0x2ab53e0 for QP
[17408] GDS WARN  gds_create_qp() using peer res_domain 0x2ab53e0 for QP
[17019] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc3c40 for QP
[17019] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc3c40 for QP
[27549] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff15d0 for QP
[27549] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff15d0 for QP
[17408] GDS WARN  gds_create_qp() using peer res_domain 0x2adef60 for QP
[17408] GDS WARN  gds_create_qp() using peer res_domain 0x2adef60 for QP
[17019] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fed7d0 for QP
[17019] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fed7d0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.105450 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.623765 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.019355 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002760 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000895 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000160 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000137 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000671 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000137 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000916 seconds)
  Building MPI subcommunicator for level 2... done (0.000044 seconds)
  Building MPI subcommunicator for level 3... done (0.000032 seconds)
  Building MPI subcommunicator for level 4... done (0.000037 seconds)
  Building MPI subcommunicator for level 5... done (0.000033 seconds)
  Building MPI subcommunicator for level 6... done (0.000030 seconds)
  Building MPI subcommunicator for level 7... done (0.000034 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.126862 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036358 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012665 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.012902 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003291 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002379 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.226435 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129569 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128430 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126913 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127375 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127521 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128798 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127121 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131869 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128372 seconds)

WARMUP TIME: 1.382979


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128395 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129211 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126946 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126774 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128191 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126059 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129011 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128342 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127333 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130970 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129510 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127508 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130659 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127948 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127986 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131510 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128215 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128352 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128262 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129029 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127940 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130792 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130360 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130938 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129704 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127576 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130250 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127910 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130262 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126666 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127334 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129727 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129116 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130121 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128911 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128282 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128891 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129271 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130344 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130542 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128684 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128704 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128177 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127669 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127414 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129473 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131520 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130727 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131198 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127895 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127961 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133005 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129042 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130198 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129669 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128784 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128786 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126590 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129455 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127879 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129027 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128711 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128038 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129465 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128931 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127571 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128219 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127518 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127824 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131481 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131297 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128436 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130168 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128594 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128510 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127684 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127562 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129853 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128848 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129500 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128120 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129149 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130303 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128745 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128477 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129567 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128276 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128789 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126444 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128465 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129574 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128773 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130147 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128777 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128880 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127148 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127855 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126950 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128392 seconds)

EXEC_TIME TIME: 12.893015


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000047     0.000096     0.000143     0.000188     0.003359     0.000675     0.000164     0.000000     0.004672
residual                      0.000008     0.000009     0.000013     0.000016     0.000456     0.000081     0.000019     0.000008     0.000610
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.040619     0.000004     0.000007     0.000011     0.000032     0.000014     0.000012     0.000031     0.040730
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000117     0.000227     0.000342     0.000449     0.000618     0.000318     0.000216     0.000042     0.002329
Restriction                   0.000011     0.000015     0.000021     0.061023     0.000024     0.000070     0.000100     0.000000     0.061265
  local restriction           0.000011     0.000014     0.000020     0.001268     0.000022     0.000005     0.000003     0.000000     0.001343
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000049     0.000077     0.000000     0.000127
Interpolation                 0.000179     0.000256     0.000320     0.000470     0.000239     0.000290     0.000969     0.000000     0.002724
  local interpolation         0.000010     0.000014     0.000019     0.000263     0.000110     0.000019     0.000005     0.000000     0.000441
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000019     0.000016     0.000000     0.000035
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000135     0.000928     0.000000     0.001062
Ghost Zone Exchange           0.001218     0.002356     0.003476     0.004463     0.002394     0.002120     0.001081     0.000004     0.017113
  local exchange              0.000061     0.000119     0.000174     0.000234     0.000251     0.000105     0.000074     0.000000     0.001019
  pack MPI buffers            0.000061     0.000120     0.000176     0.000243     0.000180     0.000080     0.000065     0.000000     0.000924
  unpack MPI buffers          0.000055     0.000111     0.000165     0.000219     0.000237     0.000111     0.000073     0.000000     0.000972
  MPI_Isend                   0.000276     0.000560     0.000862     0.001150     0.000485     0.001066     0.000252     0.000000     0.004652
  MPI_Irecv                   0.000238     0.000490     0.000793     0.000994     0.000240     0.000256     0.000192     0.000000     0.003202
  MPI_Waitall                 0.000184     0.000365     0.000548     0.000740     0.000969     0.000469     0.000390     0.000000     0.003664
MPI_collectives               0.000230     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000201     0.000431
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042387     0.002811     0.004105     0.066370     0.006915     0.003456     0.002461     0.000339     0.128842

   Total time in MGBuild      0.459025 seconds
   Total time in MGSolve      0.128860 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.128860  DOF/s=4.394e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130204 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 7 8
[hsw212:27571] Warning: could not find environment variable "MP_ENABLE_WARN"


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[16953] [3] MP INFO mp_init() using IB device: mlx5_0 
[16953] [3] MP INFO mp_init() HCA dev: mlx5_0
[17451] [1] MP INFO mp_init() using IB device: mlx5_0 
[17451] [1] MP INFO mp_init() HCA dev: mlx5_0
[17062] [2] MP INFO mp_init() using IB device: mlx5_0 
[17062] [2] MP INFO mp_init() HCA dev: mlx5_0
[16953] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1ac0 for QP
[16953] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1ac0 for QP
[17451] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1d50 for QP
[17451] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1d50 for QP
[16953] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6640 for QP
[16953] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc6640 for QP
[27598] [0] MP INFO mp_init() using IB device: mlx5_0 
[27598] [0] MP INFO mp_init() HCA dev: mlx5_0
[17062] GDS WARN  gds_create_qp() using peer res_domain 0xf7c990 for QP
[17062] GDS WARN  gds_create_qp() using peer res_domain 0xf7c990 for QP
[17451] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc68b0 for QP
[17451] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc68b0 for QP
[16953] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0640 for QP
[16953] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0640 for QP
[17451] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0870 for QP
[17451] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0870 for QP
[27598] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1b00 for QP
[27598] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1b00 for QP
[17062] GDS WARN  gds_create_qp() using peer res_domain 0x2a98da0 for QP
[17062] GDS WARN  gds_create_qp() using peer res_domain 0x2a98da0 for QP
[27598] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc65f0 for QP
[27598] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fc65f0 for QP
[17062] GDS WARN  gds_create_qp() using peer res_domain 0x2ac2d70 for QP
[17062] GDS WARN  gds_create_qp() using peer res_domain 0x2ac2d70 for QP
[27598] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff05b0 for QP
[27598] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff05b0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.103578 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (3.001601 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.018811 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002321 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000907 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000364 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000152 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000698 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000136 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001558 seconds)
  Building MPI subcommunicator for level 2... done (0.000051 seconds)
  Building MPI subcommunicator for level 3... done (0.000032 seconds)
  Building MPI subcommunicator for level 4... done (0.000035 seconds)
  Building MPI subcommunicator for level 5... done (0.000031 seconds)
  Building MPI subcommunicator for level 6... done (0.000034 seconds)
  Building MPI subcommunicator for level 7... done (0.000033 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.129106 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036438 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012683 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011734 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003413 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002607 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000058 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.226119 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130024 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128724 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129192 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128888 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129422 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129340 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128662 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129780 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127096 seconds)

WARMUP TIME: 1.387818


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127918 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129587 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127503 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127264 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126834 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128030 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129951 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128433 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128664 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129792 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129620 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128785 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129640 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128081 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127269 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128199 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129319 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129592 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130230 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128857 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128570 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129422 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128243 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129685 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129883 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128684 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127585 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130592 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127663 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127866 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129761 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127547 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128553 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130543 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130144 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131038 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127947 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133467 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130739 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129802 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128163 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127342 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130036 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128536 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128328 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127327 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128425 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126691 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128757 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127922 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126469 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130507 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128577 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129877 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129172 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127170 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128159 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130281 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130069 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129122 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130627 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129199 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131963 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126787 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127338 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130264 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127321 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.134928 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128561 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129769 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129573 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131156 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128795 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127246 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128321 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127987 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130251 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128411 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128333 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130606 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127926 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129101 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128302 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128574 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131818 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127736 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127218 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126069 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128858 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128305 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128581 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127641 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127910 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128274 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130089 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128251 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129071 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127357 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127859 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127952 seconds)

EXEC_TIME TIME: 12.892333


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000096     0.000141     0.000190     0.003381     0.000676     0.000163     0.000000     0.004694
residual                      0.000008     0.000008     0.000013     0.000016     0.000456     0.000079     0.000019     0.000008     0.000608
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000036     0.000036
BLAS1                         0.040636     0.000004     0.000007     0.000011     0.000032     0.000014     0.000012     0.000031     0.040747
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000115     0.000225     0.000334     0.000440     0.000620     0.000323     0.000212     0.000043     0.002311
Restriction                   0.000011     0.000015     0.000020     0.061177     0.000024     0.000102     0.000071     0.000000     0.061421
  local restriction           0.000010     0.000014     0.000019     0.001255     0.000022     0.000005     0.000003     0.000000     0.001329
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000016     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000082     0.000048     0.000000     0.000129
Interpolation                 0.000179     0.000254     0.000319     0.000453     0.000250     0.000246     0.001023     0.000000     0.002723
  local interpolation         0.000010     0.000014     0.000019     0.000259     0.000110     0.000018     0.000005     0.000000     0.000435
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000016     0.000016     0.000000     0.000032
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000101     0.000981     0.000000     0.001082
Ghost Zone Exchange           0.001211     0.002342     0.003453     0.004451     0.002481     0.001927     0.001024     0.000004     0.016893
  local exchange              0.000059     0.000117     0.000172     0.000230     0.000250     0.000103     0.000074     0.000000     0.001006
  pack MPI buffers            0.000060     0.000121     0.000174     0.000242     0.000181     0.000078     0.000064     0.000000     0.000921
  unpack MPI buffers          0.000054     0.000108     0.000159     0.000214     0.000240     0.000119     0.000075     0.000000     0.000968
  MPI_Isend                   0.000277     0.000561     0.000864     0.001157     0.000488     0.000813     0.000232     0.000000     0.004392
  MPI_Irecv                   0.000237     0.000489     0.000789     0.000998     0.000240     0.000260     0.000173     0.000000     0.003186
  MPI_Waitall                 0.000178     0.000355     0.000535     0.000724     0.001051     0.000519     0.000371     0.000000     0.003734
MPI_collectives               0.000263     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000199     0.000462
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042428     0.002791     0.004071     0.066487     0.007049     0.003245     0.002430     0.000337     0.128838

   Total time in MGBuild      0.460987 seconds
   Total time in MGSolve      0.128855 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.128855  DOF/s=4.394e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130595 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 7 8
[hsw212:27627] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[16990] [3] MP INFO mp_init() using IB device: mlx5_0 
[16990] [3] MP INFO mp_init() HCA dev: mlx5_0
[17488] [1] MP INFO mp_init() using IB device: mlx5_0 
[17488] [1] MP INFO mp_init() HCA dev: mlx5_0
[17100] [2] MP INFO mp_init() using IB device: mlx5_0 
[17100] [2] MP INFO mp_init() HCA dev: mlx5_0
[16990] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe6942c0 for QP
[16990] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe6942c0 for QP
[17488] GDS WARN  gds_create_qp() using peer res_domain 0xf9a020 for QP
[17488] GDS WARN  gds_create_qp() using peer res_domain 0xf9a020 for QP
[16990] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bc9a0 for QP
[16990] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bc9a0 for QP
[17100] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4c6b20 for QP
[17100] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4c6b20 for QP
[27654] [0] MP INFO mp_init() using IB device: mlx5_0 
[27654] [0] MP INFO mp_init() HCA dev: mlx5_0
[17488] GDS WARN  gds_create_qp() using peer res_domain 0x2ab64f0 for QP
[17488] GDS WARN  gds_create_qp() using peer res_domain 0x2ab64f0 for QP
[16990] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e6560 for QP
[16990] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e6560 for QP
[17100] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fee6d0 for QP
[17100] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fee6d0 for QP
[17488] GDS WARN  gds_create_qp() using peer res_domain 0x2ae04b0 for QP
[17488] GDS WARN  gds_create_qp() using peer res_domain 0x2ae04b0 for QP
[27654] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe694320 for QP
[27654] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe694320 for QP
[17100] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae14196d0 for QP
[17100] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae14196d0 for QP
[27654] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bea80 for QP
[27654] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51bea80 for QP
[27654] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e8670 for QP
[27654] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae51e8670 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.108213 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.600696 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.019379 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002729 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000932 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000212 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000119 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000671 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000129 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000851 seconds)
  Building MPI subcommunicator for level 2... done (0.000053 seconds)
  Building MPI subcommunicator for level 3... done (0.000030 seconds)
  Building MPI subcommunicator for level 4... done (0.000035 seconds)
  Building MPI subcommunicator for level 5... done (0.000037 seconds)
  Building MPI subcommunicator for level 6... done (0.000033 seconds)
  Building MPI subcommunicator for level 7... done (0.000037 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.128575 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036537 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012607 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011066 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003310 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002390 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.223929 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128288 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129493 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128377 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127390 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131318 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132001 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129169 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131465 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128430 seconds)

WARMUP TIME: 1.390504


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127705 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132196 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127784 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130139 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132873 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129990 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129444 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130702 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131593 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127314 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130432 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129429 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130419 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129976 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131439 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129428 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130311 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132356 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127067 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129991 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129780 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129528 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129489 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130985 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130936 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131159 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129411 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130583 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130018 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130940 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127795 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128143 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129278 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128117 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129971 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129827 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128820 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127845 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129223 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130962 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129919 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129120 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130186 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128463 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127212 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132584 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127062 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129004 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130090 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129206 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128974 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129399 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.133949 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127882 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130703 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127820 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128217 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129302 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130698 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128921 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131557 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129365 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129963 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129954 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132946 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129155 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132708 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130436 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129649 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127562 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132001 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129117 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131628 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128302 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129712 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129704 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129336 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129677 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132243 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127738 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129932 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132086 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130969 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129452 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129408 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129949 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129453 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127414 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128192 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130056 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127671 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130858 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128948 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128905 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130048 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131874 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128807 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129386 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128512 seconds)

EXEC_TIME TIME: 12.981932


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000094     0.000142     0.000189     0.003436     0.000649     0.000152     0.000000     0.004710
residual                      0.000008     0.000009     0.000013     0.000016     0.000463     0.000079     0.000018     0.000008     0.000616
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.040652     0.000004     0.000007     0.000011     0.000032     0.000014     0.000010     0.000030     0.040761
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000113     0.000223     0.000328     0.000441     0.000660     0.000339     0.000239     0.000045     0.002389
Restriction                   0.000011     0.000015     0.000021     0.061183     0.000023     0.000077     0.000074     0.000000     0.061404
  local restriction           0.000010     0.000014     0.000020     0.001253     0.000021     0.000006     0.000003     0.000000     0.001327
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000015     0.000000     0.000026
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000056     0.000050     0.000000     0.000106
Interpolation                 0.000179     0.000256     0.000318     0.000450     0.000277     0.000236     0.002006     0.000000     0.003722
  local interpolation         0.000009     0.000014     0.000019     0.000266     0.000112     0.000019     0.000005     0.000000     0.000444
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000011     0.000000     0.000016
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000026
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000094     0.001961     0.000000     0.002055
Ghost Zone Exchange           0.001216     0.002358     0.003469     0.004488     0.002103     0.001718     0.001387     0.000005     0.016743
  local exchange              0.000061     0.000122     0.000178     0.000236     0.000270     0.000086     0.000083     0.000000     0.001035
  pack MPI buffers            0.000061     0.000120     0.000174     0.000245     0.000195     0.000089     0.000068     0.000000     0.000953
  unpack MPI buffers          0.000055     0.000109     0.000164     0.000217     0.000252     0.000101     0.000080     0.000000     0.000979
  MPI_Isend                   0.000275     0.000563     0.000864     0.001161     0.000557     0.000680     0.000201     0.000000     0.004301
  MPI_Irecv                   0.000234     0.000488     0.000787     0.001009     0.000242     0.000251     0.000167     0.000000     0.003179
  MPI_Waitall                 0.000180     0.000359     0.000537     0.000731     0.000557     0.000480     0.000755     0.000000     0.003599
MPI_collectives               0.000239     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000190     0.000429
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042422     0.002806     0.004080     0.066528     0.006811     0.002962     0.003792     0.000328     0.129730

   Total time in MGBuild      0.459442 seconds
   Total time in MGSolve      0.129749 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.129749  DOF/s=4.364e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130218 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 7 8
[hsw212:27689] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/2 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 2 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[17046] [3] MP INFO mp_init() using IB device: mlx5_0 
[17046] [3] MP INFO mp_init() HCA dev: mlx5_0
[17157] [2] MP INFO mp_init() using IB device: mlx5_0 
[17157] [2] MP INFO mp_init() HCA dev: mlx5_0
[17545] [1] MP INFO mp_init() using IB device: mlx5_0 
[17545] [1] MP INFO mp_init() HCA dev: mlx5_0
[27716] [0] MP INFO mp_init() using IB device: mlx5_0 
[27716] [0] MP INFO mp_init() HCA dev: mlx5_0
[17046] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a17b0 for QP
[17046] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a17b0 for QP
[17157] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4c6280 for QP
[17157] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4c6280 for QP
[17545] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1770 for QP
[17545] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4a1770 for QP
[27716] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabfe154b0 for QP
[27716] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabfe154b0 for QP
[17046] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fcb2c0 for QP
[17046] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fcb2c0 for QP
[17545] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fcb240 for QP
[17545] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fcb240 for QP
[17157] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0d60 for QP
[17157] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff0d60 for QP
[27716] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae49426d0 for QP
[27716] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae49426d0 for QP
[17046] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff5690 for QP
[17046] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff5690 for QP
[17157] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1428d50 for QP
[17157] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1428d50 for QP
[17545] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff5240 for QP
[17545] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ff5240 for QP
[27716] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae496c6a0 for QP
[27716] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae496c6a0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.105485 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.578318 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.019131 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002835 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000940 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000238 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000158 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000662 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000135 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001159 seconds)
  Building MPI subcommunicator for level 2... done (0.000049 seconds)
  Building MPI subcommunicator for level 3... done (0.000033 seconds)
  Building MPI subcommunicator for level 4... done (0.000032 seconds)
  Building MPI subcommunicator for level 5... done (0.000034 seconds)
  Building MPI subcommunicator for level 6... done (0.000032 seconds)
  Building MPI subcommunicator for level 7... done (0.000040 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.128701 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036869 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012636 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010536 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003336 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002407 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.223006 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130942 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130836 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129378 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129747 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129070 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129495 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129229 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129955 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130399 seconds)

WARMUP TIME: 1.392632


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129014 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130324 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129439 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129451 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129390 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130220 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130148 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128881 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129085 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130895 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129962 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127961 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132066 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128806 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131681 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129464 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128688 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126912 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131969 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127791 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127788 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129109 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129944 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127865 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130148 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130915 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131111 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130775 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128940 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128914 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129897 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126872 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129115 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129439 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128304 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128179 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128732 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128469 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131393 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127637 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129561 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129619 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129003 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129898 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129453 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127428 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129718 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128109 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128953 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126912 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129402 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128370 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129977 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127487 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129647 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127065 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129328 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128177 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128303 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127550 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128702 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127924 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128158 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128381 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128509 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129940 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127937 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130437 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129236 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129562 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130504 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131956 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130617 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132377 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127858 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128545 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130514 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127830 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127782 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130116 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128895 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129890 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127019 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130474 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128418 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129111 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128714 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127717 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130202 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129102 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129186 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131520 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128399 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127460 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129930 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128858 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132041 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129369 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131489 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127919 seconds)

EXEC_TIME TIME: 12.928433


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000050     0.000098     0.000142     0.000194     0.003437     0.000620     0.000168     0.000000     0.004707
residual                      0.000008     0.000009     0.000013     0.000017     0.000464     0.000076     0.000020     0.000008     0.000615
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.040634     0.000004     0.000008     0.000011     0.000032     0.000013     0.000013     0.000030     0.040744
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000116     0.000225     0.000337     0.000447     0.000656     0.000331     0.000240     0.000046     0.002396
Restriction                   0.000011     0.000015     0.000021     0.060996     0.000023     0.000080     0.000069     0.000000     0.061214
  local restriction           0.000010     0.000014     0.000020     0.001262     0.000021     0.000005     0.000003     0.000000     0.001335
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000026
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000060     0.000045     0.000000     0.000105
Interpolation                 0.000180     0.000283     0.000321     0.000480     0.000247     0.000169     0.002122     0.000000     0.003802
  local interpolation         0.000010     0.000038     0.000019     0.000272     0.000113     0.000019     0.000005     0.000000     0.000476
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000010     0.000000     0.000016
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000016     0.000000     0.000027
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000013     0.002077     0.000000     0.002090
Ghost Zone Exchange           0.001221     0.002362     0.003478     0.004523     0.002131     0.001593     0.001026     0.000004     0.016338
  local exchange              0.000061     0.000118     0.000176     0.000232     0.000267     0.000087     0.000083     0.000000     0.001025
  pack MPI buffers            0.000061     0.000121     0.000174     0.000245     0.000196     0.000092     0.000071     0.000000     0.000960
  unpack MPI buffers          0.000055     0.000111     0.000165     0.000220     0.000257     0.000099     0.000082     0.000000     0.000989
  MPI_Isend                   0.000279     0.000568     0.000871     0.001175     0.000534     0.000608     0.000226     0.000000     0.004261
  MPI_Irecv                   0.000239     0.000494     0.000794     0.001032     0.000242     0.000247     0.000171     0.000000     0.003218
  MPI_Waitall                 0.000182     0.000361     0.000544     0.000739     0.000604     0.000428     0.000359     0.000000     0.003217
MPI_collectives               0.000236     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000198     0.000434
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042408     0.002843     0.004099     0.066415     0.006781     0.002765     0.003545     0.000336     0.129193

   Total time in MGBuild      0.459278 seconds
   Total time in MGSolve      0.129211 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.129211  DOF/s=4.382e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128716 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0
