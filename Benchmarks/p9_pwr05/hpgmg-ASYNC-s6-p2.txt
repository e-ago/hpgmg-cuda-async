./run.sh 2 1 1 0 6 8
[pwr05:159733] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:159747][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:159746][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882183.613300] [pwr05:159747:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882183.613305] [pwr05:159746:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[159746] [0] MP INFO mp_init() using IB device: mlx5_0 
[159746] [0] MP INFO mp_init() HCA dev: mlx5_0
[159747] [1] MP INFO mp_init() using IB device: mlx5_2 
[159747] [1] MP INFO mp_init() HCA dev: mlx5_2


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001904 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159746] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159747] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.213645 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001136 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000147 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000256 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000199 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000151 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000126 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000302 seconds)
  Building MPI subcommunicator for level 2... done (0.000033 seconds)
  Building MPI subcommunicator for level 3... done (0.000027 seconds)
  Building MPI subcommunicator for level 4... done (0.000037 seconds)
  Building MPI subcommunicator for level 5... done (0.000022 seconds)
  Building MPI subcommunicator for level 6... done (0.000022 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.063332 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.070635 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.008175 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001636 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000486 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000055 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045485 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068089 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050480 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045216 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.073264 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058655 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039649 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019076 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074821 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059814 seconds)

WARMUP TIME: 0.535072


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071987 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059763 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036685 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047685 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027549 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029245 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057189 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019288 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069163 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045821 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039503 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033628 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074186 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051958 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044008 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029142 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015849 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059881 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.053782 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046669 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054599 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045761 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062952 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055257 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.070453 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063327 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037634 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054301 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026999 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022572 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074199 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.064116 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050000 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054805 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037193 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065208 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046302 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025328 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029067 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.053289 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024014 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049962 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036624 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028991 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076403 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046251 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.064065 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015394 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.085491 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035053 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015471 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042986 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063924 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046917 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.080985 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066109 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074801 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062568 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063450 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030866 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051703 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031111 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019472 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055835 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023061 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050269 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.087760 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058330 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062314 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022412 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016391 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028548 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033035 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035857 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022503 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046450 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054130 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020909 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.032450 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016424 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027399 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027152 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.075921 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074940 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036749 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057124 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.041500 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055225 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047702 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050996 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063395 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.083064 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018474 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056031 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025453 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.067603 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071536 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.075912 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.098948 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017193 seconds)

EXEC_TIME TIME: 4.762976


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000082     0.000161     0.000247     0.001950     0.000588     0.000172     0.000000     0.003200
residual                      0.000013     0.000014     0.000020     0.000277     0.000085     0.000020     0.000010     0.000439
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000026     0.000026
BLAS1                         0.010169     0.000006     0.000013     0.000025     0.000011     0.000008     0.000156     0.010388
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000178     0.000354     0.000545     0.000440     0.000286     0.000217     0.000061     0.002081
Restriction                   0.000017     0.000023     0.025663     0.000088     0.000011     0.000010     0.000000     0.025811
  local restriction           0.000016     0.000023     0.000349     0.000021     0.000009     0.000008     0.000000     0.000427
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000006     0.000000     0.000000     0.000000     0.000006
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000051     0.000000     0.000000     0.000000     0.000051
Interpolation                 0.000141     0.000215     0.000287     0.000247     0.000048     0.000028     0.000000     0.000965
  local interpolation         0.000015     0.000022     0.000192     0.000137     0.000026     0.000011     0.000000     0.000402
  pack MPI buffers            0.000000     0.000000     0.000000     0.000076     0.000000     0.000000     0.000000     0.000076
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000713     0.001410     0.002164     0.000736     0.000007     0.000008     0.000003     0.005042
  local exchange              0.000090     0.000184     0.000277     0.000144     0.000000     0.000000     0.000000     0.000695
  pack MPI buffers            0.000092     0.000183     0.000286     0.000135     0.000000     0.000000     0.000000     0.000696
  unpack MPI buffers          0.000090     0.000178     0.000278     0.000128     0.000000     0.000000     0.000000     0.000675
  MPI_Isend                   0.000121     0.000242     0.000375     0.000054     0.000000     0.000000     0.000000     0.000791
  MPI_Irecv                   0.000084     0.000163     0.000259     0.000060     0.000000     0.000000     0.000000     0.000566
  MPI_Waitall                 0.000173     0.000353     0.000550     0.000181     0.000000     0.000000     0.000000     0.001257
MPI_collectives               0.000039     0.000000     0.000000     0.000000     0.000000     0.000000     0.000008     0.000047
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.011317     0.002071     0.028773     0.003669     0.001023     0.000459     0.000254     0.047567

   Total time in MGBuild      0.188253 seconds
   Total time in MGSolve      0.047576 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.047576  DOF/s=4.408e+07  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024517 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 2 1 1 0 6 8
[pwr05:159791] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:159805][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:159804][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882194.873513] [pwr05:159805:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882194.873517] [pwr05:159804:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[159805] [1] MP INFO mp_init() using IB device: mlx5_2 
[159805] [1] MP INFO mp_init() HCA dev: mlx5_2
[159804] [0] MP INFO mp_init() using IB device: mlx5_0 
[159804] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000695 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159805] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159804] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  done (0.061655 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000970 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000361 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000562 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000264 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000179 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000131 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000284 seconds)
  Building MPI subcommunicator for level 2... done (0.000037 seconds)
  Building MPI subcommunicator for level 3... done (0.000031 seconds)
  Building MPI subcommunicator for level 4... done (0.000039 seconds)
  Building MPI subcommunicator for level 5... done (0.000024 seconds)
  Building MPI subcommunicator for level 6... done (0.000024 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.058722 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.055182 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.009231 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.002036 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000589 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000065 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040977 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016735 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062250 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.081581 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031487 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051289 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016748 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049605 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058896 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017899 seconds)

WARMUP TIME: 0.428074


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057288 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.073644 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.089929 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071890 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076626 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065318 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.082100 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016594 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060102 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052044 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056019 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.073170 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076093 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048141 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042777 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035957 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040419 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071225 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063386 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040392 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051825 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065472 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068128 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.084173 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066721 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040193 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065899 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045637 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048829 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056725 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044838 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.087271 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052493 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030740 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076064 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018465 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052220 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.070678 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049134 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.032933 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057203 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.034572 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029173 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035120 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051336 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020389 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058777 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020448 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028021 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027072 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026838 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029159 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054237 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.032432 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066903 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029446 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048659 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018472 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042742 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045697 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.078402 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031141 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024880 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021998 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062795 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068943 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057011 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.084080 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031376 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061226 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.081452 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050190 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046685 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050881 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074037 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020562 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057070 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069730 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.073146 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042923 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028032 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039493 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061922 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.064224 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.053197 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.043493 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031749 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068990 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072280 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.067662 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061033 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066627 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060464 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047698 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051981 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059052 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049044 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.084829 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058409 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061570 seconds)

EXEC_TIME TIME: 5.283614


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000087     0.000168     0.000258     0.001982     0.000607     0.000178     0.000000     0.003280
residual                      0.000014     0.000014     0.000022     0.000289     0.000089     0.000021     0.000011     0.000460
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000027     0.000027
BLAS1                         0.010712     0.000007     0.000013     0.000026     0.000011     0.000008     0.000163     0.010941
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000187     0.000372     0.000575     0.000457     0.000296     0.000223     0.000063     0.002174
Restriction                   0.000017     0.000023     0.029982     0.000066     0.000011     0.000010     0.000000     0.030110
  local restriction           0.000017     0.000023     0.000350     0.000023     0.000010     0.000009     0.000000     0.000431
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000027     0.000000     0.000000     0.000000     0.000027
Interpolation                 0.000148     0.000226     0.000321     0.000193     0.000049     0.000030     0.000000     0.000967
  local interpolation         0.000015     0.000024     0.000227     0.000079     0.000027     0.000012     0.000000     0.000384
  pack MPI buffers            0.000000     0.000000     0.000000     0.000078     0.000000     0.000000     0.000000     0.000078
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000746     0.001486     0.002274     0.000686     0.000008     0.000008     0.000004     0.005212
  local exchange              0.000094     0.000191     0.000291     0.000150     0.000000     0.000000     0.000000     0.000726
  pack MPI buffers            0.000097     0.000194     0.000300     0.000141     0.000000     0.000000     0.000000     0.000731
  unpack MPI buffers          0.000094     0.000189     0.000293     0.000131     0.000000     0.000000     0.000000     0.000707
  MPI_Isend                   0.000126     0.000253     0.000392     0.000043     0.000000     0.000000     0.000000     0.000814
  MPI_Irecv                   0.000088     0.000173     0.000274     0.000067     0.000000     0.000000     0.000000     0.000602
  MPI_Waitall                 0.000180     0.000369     0.000575     0.000119     0.000000     0.000000     0.000000     0.001243
MPI_collectives               0.000040     0.000000     0.000000     0.000000     0.000000     0.000000     0.000008     0.000048
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.011915     0.002179     0.033268     0.003607     0.001059     0.000476     0.000266     0.052771

   Total time in MGBuild      0.171053 seconds
   Total time in MGSolve      0.052782 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.052782  DOF/s=3.973e+07  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076423 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 2 1 1 0 6 8
[pwr05:159848] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:159862][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:159861][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882206.929795] [pwr05:159862:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882206.929800] [pwr05:159861:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[159862] [1] MP INFO mp_init() using IB device: mlx5_2 
[159862] [1] MP INFO mp_init() HCA dev: mlx5_2
[159861] [0] MP INFO mp_init() using IB device: mlx5_0 
[159861] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.011245 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159861] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159862] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.215825 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001208 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000290 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000138 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000223 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000152 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000107 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000258 seconds)
  Building MPI subcommunicator for level 2... done (0.000035 seconds)
  Building MPI subcommunicator for level 3... done (0.000027 seconds)
  Building MPI subcommunicator for level 4... done (0.000037 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000023 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.069064 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.049776 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.008062 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001632 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000490 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039721 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.075496 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060654 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076894 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059843 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035849 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.073080 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052210 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018843 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069524 seconds)

WARMUP TIME: 0.562639


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062229 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069290 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037171 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044873 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040049 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026696 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044198 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040282 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057041 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059501 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044892 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025832 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038537 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017441 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016735 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042231 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051273 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016680 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047506 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.043768 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016779 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055243 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017086 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037532 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052246 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024355 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045368 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055449 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028996 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057629 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025486 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016748 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045441 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038425 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055440 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063660 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039112 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038182 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039792 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052046 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069338 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022520 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016663 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024132 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037588 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048860 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023328 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017464 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016716 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016696 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020225 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016641 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021929 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024336 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.041013 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060365 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017076 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063332 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016705 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017421 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024094 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.073259 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048382 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059455 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.077907 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054612 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036127 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044713 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051176 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050455 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076568 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052971 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066379 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021324 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058305 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.067281 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045690 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.080097 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036029 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.078885 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045185 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063905 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037463 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060298 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047732 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054492 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.083370 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060715 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023712 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027302 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057405 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.081963 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051861 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.067195 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.032206 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042722 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037807 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019033 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071056 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055734 seconds)

EXEC_TIME TIME: 4.353582


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000096     0.000185     0.000280     0.002094     0.000628     0.000190     0.000000     0.003474
residual                      0.000016     0.000016     0.000023     0.000309     0.000096     0.000022     0.000012     0.000495
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000029     0.000029
BLAS1                         0.009225     0.000008     0.000014     0.000027     0.000012     0.000009     0.000175     0.009471
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000204     0.000402     0.000616     0.000486     0.000312     0.000236     0.000067     0.002323
Restriction                   0.000018     0.000026     0.021319     0.000086     0.000012     0.000011     0.000000     0.021473
  local restriction           0.000018     0.000025     0.000337     0.000025     0.000011     0.000009     0.000000     0.000426
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000043     0.000000     0.000000     0.000000     0.000043
Interpolation                 0.000159     0.000244     0.000308     0.000203     0.000052     0.000032     0.000000     0.000998
  local interpolation         0.000016     0.000025     0.000213     0.000084     0.000028     0.000012     0.000000     0.000379
  pack MPI buffers            0.000000     0.000000     0.000000     0.000082     0.000000     0.000000     0.000000     0.000082
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000815     0.001613     0.002458     0.000697     0.000009     0.000009     0.000004     0.005605
  local exchange              0.000103     0.000208     0.000313     0.000157     0.000000     0.000000     0.000000     0.000781
  pack MPI buffers            0.000105     0.000211     0.000322     0.000150     0.000000     0.000000     0.000000     0.000788
  unpack MPI buffers          0.000102     0.000203     0.000315     0.000137     0.000000     0.000000     0.000000     0.000757
  MPI_Isend                   0.000141     0.000282     0.000432     0.000045     0.000000     0.000000     0.000000     0.000900
  MPI_Irecv                   0.000097     0.000190     0.000297     0.000076     0.000000     0.000000     0.000000     0.000661
  MPI_Waitall                 0.000203     0.000414     0.000636     0.000094     0.000000     0.000000     0.000000     0.001348
MPI_collectives               0.000063     0.000000     0.000000     0.000000     0.000000     0.000000     0.000009     0.000071
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.010561     0.002366     0.024829     0.003811     0.001109     0.000507     0.000287     0.043469

   Total time in MGBuild      0.172512 seconds
   Total time in MGSolve      0.043481 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.043481  DOF/s=4.823e+07  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.080646 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 2 1 1 0 6 8
[pwr05:159906] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:159920][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:159919][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882217.847339] [pwr05:159920:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882217.847346] [pwr05:159919:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[159920] [1] MP INFO mp_init() using IB device: mlx5_2 
[159920] [1] MP INFO mp_init() HCA dev: mlx5_2
[159919] [0] MP INFO mp_init() using IB device: mlx5_0 
[159919] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.009422 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159919] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159920] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.240603 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000772 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000175 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000256 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000206 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000151 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000115 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000296 seconds)
  Building MPI subcommunicator for level 2... done (0.000033 seconds)
  Building MPI subcommunicator for level 3... done (0.000026 seconds)
  Building MPI subcommunicator for level 4... done (0.000037 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.066333 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.045555 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.007931 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001674 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000493 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.087190 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.041258 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046623 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019458 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.041474 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048946 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061732 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040099 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054904 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040808 seconds)

WARMUP TIME: 0.483045


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019464 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030757 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.053251 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039829 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038948 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.070217 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033613 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054010 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.078170 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030483 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019969 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060735 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.077701 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016211 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050345 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042865 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031361 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068611 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035340 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.070644 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063443 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015451 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037033 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069038 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057321 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018854 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060859 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074121 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056984 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022964 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052232 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040940 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046869 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017037 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016277 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047422 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016648 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016274 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048659 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017061 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024330 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044977 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.035623 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048905 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022687 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029612 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.040322 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.089206 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016719 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050771 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030100 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021237 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018193 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033306 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016329 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016659 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.092658 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024802 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046978 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.029807 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030223 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033168 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.087720 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038288 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016588 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048482 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057553 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020414 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054133 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054188 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.034107 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.084551 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066662 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031376 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049692 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021941 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065975 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071853 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066750 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054430 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046103 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031775 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060548 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018592 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060224 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.078802 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031609 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045681 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052827 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037200 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047843 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049505 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015405 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031117 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050606 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038352 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060560 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055058 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048522 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042925 seconds)

EXEC_TIME TIME: 4.347566


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000084     0.000164     0.000249     0.001958     0.000590     0.000173     0.000000     0.003217
residual                      0.000014     0.000014     0.000020     0.000281     0.000086     0.000020     0.000011     0.000445
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000026     0.000026
BLAS1                         0.008237     0.000007     0.000013     0.000026     0.000011     0.000008     0.000158     0.008459
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000183     0.000360     0.000554     0.000447     0.000290     0.000218     0.000061     0.002113
Restriction                   0.000017     0.000023     0.023175     0.000111     0.000011     0.000010     0.000000     0.023346
  local restriction           0.000016     0.000023     0.000347     0.000021     0.000009     0.000009     0.000000     0.000425
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000006     0.000000     0.000000     0.000000     0.000006
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000074     0.000000     0.000000     0.000000     0.000074
Interpolation                 0.000144     0.000219     0.000278     0.000189     0.000048     0.000029     0.000000     0.000907
  local interpolation         0.000015     0.000023     0.000178     0.000078     0.000026     0.000011     0.000000     0.000332
  pack MPI buffers            0.000000     0.000000     0.000000     0.000077     0.000000     0.000000     0.000000     0.000077
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000729     0.001502     0.002205     0.000828     0.000008     0.000008     0.000004     0.005283
  local exchange              0.000092     0.000248     0.000280     0.000145     0.000000     0.000000     0.000000     0.000765
  pack MPI buffers            0.000094     0.000188     0.000292     0.000137     0.000000     0.000000     0.000000     0.000711
  unpack MPI buffers          0.000091     0.000181     0.000283     0.000131     0.000000     0.000000     0.000000     0.000685
  MPI_Isend                   0.000125     0.000248     0.000383     0.000113     0.000000     0.000000     0.000000     0.000870
  MPI_Irecv                   0.000087     0.000169     0.000266     0.000064     0.000000     0.000000     0.000000     0.000586
  MPI_Waitall                 0.000180     0.000364     0.000563     0.000205     0.000000     0.000000     0.000000     0.001312
MPI_collectives               0.000050     0.000000     0.000000     0.000000     0.000000     0.000000     0.000008     0.000058
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.009422     0.002175     0.026323     0.003741     0.001030     0.000463     0.000257     0.043412

   Total time in MGBuild      0.166754 seconds
   Total time in MGSolve      0.043423 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.043423  DOF/s=4.830e+07  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072361 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 2 1 1 0 6 8
[pwr05:159963] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:159977][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:159976][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882228.641921] [pwr05:159977:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882228.641928] [pwr05:159976:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[159977] [1] MP INFO mp_init() using IB device: mlx5_2 
[159977] [1] MP INFO mp_init() HCA dev: mlx5_2
[159976] [0] MP INFO mp_init() using IB device: mlx5_0 
[159976] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.011134 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159976] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[159977] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.228679 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000963 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000143 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000258 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000222 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000150 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000123 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000299 seconds)
  Building MPI subcommunicator for level 2... done (0.000035 seconds)
  Building MPI subcommunicator for level 3... done (0.000027 seconds)
  Building MPI subcommunicator for level 4... done (0.000039 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000022 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.056458 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.044168 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.007994 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001633 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000493 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061101 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059236 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.079119 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051002 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046745 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030613 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063687 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.047724 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057645 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061647 seconds)

WARMUP TIME: 0.559055


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055712 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039329 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.053274 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039040 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021079 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057822 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.049461 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017362 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036322 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.062351 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066338 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.070958 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046856 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050863 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.082520 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059310 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021137 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068773 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052765 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072508 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071954 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072434 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.039730 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055188 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.034499 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.070675 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065353 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054263 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.080890 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.064956 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057197 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059705 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.048012 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.063584 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056518 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.079144 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.042581 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.069914 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.044048 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.064150 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072163 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061094 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072944 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046441 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023001 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056927 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.075159 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056882 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054802 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033388 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.090461 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.083901 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.050940 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.085509 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.046023 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021693 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060784 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030822 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015442 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.055609 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016292 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030497 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027366 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019422 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.053748 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026414 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.065481 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016278 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.045950 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.081175 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016667 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072925 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.056013 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.034909 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.068585 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.052950 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.066381 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058499 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.080839 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.057341 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033058 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.076150 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071057 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.072775 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.071501 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.059742 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058918 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.051608 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060319 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.036970 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.075478 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.074372 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.038273 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.058528 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.060843 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031670 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027648 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.061775 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015438 seconds)

EXEC_TIME TIME: 5.358455


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000082     0.000160     0.000245     0.001950     0.000587     0.000172     0.000000     0.003197
residual                      0.000013     0.000014     0.000020     0.000277     0.000084     0.000020     0.000011     0.000439
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000026     0.000026
BLAS1                         0.011800     0.000006     0.000013     0.000025     0.000011     0.000008     0.000157     0.012020
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000177     0.000353     0.000542     0.000441     0.000287     0.000217     0.000061     0.002078
Restriction                   0.000016     0.000023     0.030037     0.000091     0.000010     0.000010     0.000000     0.030188
  local restriction           0.000016     0.000023     0.000350     0.000021     0.000009     0.000008     0.000000     0.000427
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000006     0.000000     0.000000     0.000000     0.000006
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000055     0.000000     0.000000     0.000000     0.000055
Interpolation                 0.000141     0.000214     0.000303     0.000187     0.000048     0.000029     0.000000     0.000922
  local interpolation         0.000015     0.000023     0.000210     0.000077     0.000026     0.000011     0.000000     0.000362
  pack MPI buffers            0.000000     0.000000     0.000000     0.000076     0.000000     0.000000     0.000000     0.000076
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000708     0.001409     0.002163     0.000716     0.000007     0.000008     0.000003     0.005015
  local exchange              0.000088     0.000181     0.000275     0.000144     0.000000     0.000000     0.000000     0.000688
  pack MPI buffers            0.000092     0.000183     0.000288     0.000136     0.000000     0.000000     0.000000     0.000699
  unpack MPI buffers          0.000088     0.000176     0.000275     0.000128     0.000000     0.000000     0.000000     0.000666
  MPI_Isend                   0.000120     0.000241     0.000373     0.000051     0.000000     0.000000     0.000000     0.000784
  MPI_Irecv                   0.000083     0.000163     0.000258     0.000061     0.000000     0.000000     0.000000     0.000565
  MPI_Waitall                 0.000171     0.000350     0.000547     0.000163     0.000000     0.000000     0.000000     0.001232
MPI_collectives               0.000059     0.000000     0.000000     0.000000     0.000000     0.000000     0.000007     0.000066
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.012959     0.002070     0.033157     0.003596     0.001022     0.000460     0.000256     0.053520

   Total time in MGBuild      0.155372 seconds
   Total time in MGSolve      0.053530 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.053530  DOF/s=3.918e+07  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.054808 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0
