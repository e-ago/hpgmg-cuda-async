./run.sh 2 1 1 1 6 8
[pwr05:160881] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:160895][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:160894][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882451.927234] [pwr05:160895:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882451.927240] [pwr05:160894:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[160895] [1] MP INFO mp_init() using IB device: mlx5_2 
[160895] [1] MP INFO mp_init() HCA dev: mlx5_2
[160894] [0] MP INFO mp_init() using IB device: mlx5_0 
[160894] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.009708 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[160895] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[160894] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  done (0.057729 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000602 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000202 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000257 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000223 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000150 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000125 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000231 seconds)
  Building MPI subcommunicator for level 2... done (0.000033 seconds)
  Building MPI subcommunicator for level 3... done (0.000026 seconds)
  Building MPI subcommunicator for level 4... done (0.000038 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.015219 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.006244 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.008169 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001624 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000492 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.031111 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016012 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021243 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015417 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015089 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021305 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015151 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015452 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015116 seconds)

WARMUP TIME: 0.182304


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015117 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015893 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015153 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015112 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019665 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015058 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015090 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015879 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015131 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015134 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015470 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023930 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019167 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015861 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022405 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018378 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015468 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015126 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018321 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015169 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015162 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016202 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015094 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015066 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015024 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019467 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025669 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015624 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018462 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015101 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015901 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015871 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017246 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024769 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015906 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016249 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017580 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015935 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016685 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015878 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015888 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016292 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015910 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015906 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016667 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022786 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015942 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016238 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015901 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015905 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016695 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019995 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015933 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016269 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015878 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015882 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016649 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015897 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016670 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016226 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015895 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015878 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016631 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015856 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015854 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015726 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015610 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015626 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015626 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015643 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015703 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015726 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015687 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015936 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016791 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025592 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016833 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018166 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015980 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016721 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017601 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020024 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019229 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015999 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018788 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016743 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016015 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015995 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016685 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015996 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015997 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018360 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018489 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017277 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017754 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015989 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022296 seconds)

EXEC_TIME TIME: 1.700682


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000098     0.000193     0.000288     0.002053     0.000639     0.000194     0.000000     0.003465
residual                      0.000017     0.000015     0.000024     0.000314     0.000098     0.000023     0.000012     0.000504
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000030     0.000030
BLAS1                         0.002523     0.000008     0.000015     0.000028     0.000012     0.000009     0.000180     0.002774
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000213     0.000423     0.000636     0.000496     0.000318     0.000239     0.000068     0.002394
Restriction                   0.000019     0.000027     0.003562     0.000064     0.000012     0.000011     0.000000     0.003695
  local restriction           0.000018     0.000026     0.000334     0.000026     0.000011     0.000010     0.000000     0.000425
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000020     0.000000     0.000000     0.000000     0.000020
Interpolation                 0.000112     0.000167     0.000307     0.000206     0.000052     0.000033     0.000000     0.000877
  local interpolation         0.000017     0.000026     0.000211     0.000085     0.000028     0.000013     0.000000     0.000380
  pack MPI buffers            0.000000     0.000000     0.000000     0.000083     0.000000     0.000000     0.000000     0.000083
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000470     0.000910     0.001368     0.000713     0.000009     0.000010     0.000005     0.003484
  local exchange              0.000152     0.000305     0.000461     0.000160     0.000000     0.000000     0.000000     0.001077
  pack MPI buffers            0.000000     0.000000     0.000000     0.000152     0.000000     0.000000     0.000000     0.000152
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000140     0.000000     0.000000     0.000000     0.000140
  MPI_Isend                   0.000017     0.000029     0.000041     0.000045     0.000000     0.000000     0.000000     0.000132
  MPI_Irecv                   0.000103     0.000199     0.000303     0.000078     0.000000     0.000000     0.000000     0.000683
  MPI_Waitall                 0.000147     0.000292     0.000439     0.000099     0.000000     0.000000     0.000000     0.000977
MPI_collectives               0.000053     0.000000     0.000000     0.000000     0.000000     0.000000     0.000009     0.000062
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.003472     0.001664     0.006086     0.003781     0.001128     0.000516     0.000293     0.016941

   Total time in MGBuild      0.075454 seconds
   Total time in MGSolve      0.016953 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.016953  DOF/s=1.237e+08  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015959 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 2 1 1 1 6 8
[pwr05:160938] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:160952][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:160951][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882459.957657] [pwr05:160952:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882459.957665] [pwr05:160951:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[160952] [1] MP INFO mp_init() using IB device: mlx5_2 
[160952] [1] MP INFO mp_init() HCA dev: mlx5_2
[160951] [0] MP INFO mp_init() using IB device: mlx5_0 
[160951] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002119 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[160951] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[160952] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.221500 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000635 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000172 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000250 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000222 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000152 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000117 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000295 seconds)
  Building MPI subcommunicator for level 2... done (0.000034 seconds)
  Building MPI subcommunicator for level 3... done (0.000026 seconds)
  Building MPI subcommunicator for level 4... done (0.000039 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.015390 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.006176 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.008069 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001656 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000494 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.032476 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015087 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015457 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015476 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015116 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017920 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017474 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015177 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015504 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027408 seconds)

WARMUP TIME: 0.187619


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015134 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015922 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015152 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015138 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015539 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015100 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015140 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015940 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015204 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017565 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015540 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015199 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015250 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015976 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016576 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027978 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015557 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015173 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015176 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020378 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015199 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018032 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022385 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015875 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016430 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015609 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015770 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019282 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017730 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015710 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017131 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015897 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016622 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027339 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015927 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016247 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021676 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021576 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016635 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015875 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015893 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016250 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015874 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023662 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016653 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015878 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015859 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018510 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015911 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021867 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023747 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015905 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015895 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016270 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015985 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016208 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016637 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015880 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015915 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016248 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015881 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027264 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019567 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019512 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019641 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019790 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019643 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019650 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019745 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018393 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016411 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015960 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022206 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016251 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028240 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019342 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019664 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019593 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019610 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020040 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019608 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019817 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018247 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015865 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015888 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016239 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016036 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020937 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016634 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015875 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018373 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020120 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025707 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015923 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016648 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025926 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018874 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023118 seconds)

EXEC_TIME TIME: 1.802916


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000100     0.000198     0.000296     0.002123     0.000641     0.000196     0.000000     0.003555
residual                      0.000017     0.000016     0.000025     0.000319     0.000100     0.000023     0.000012     0.000512
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000031     0.000031
BLAS1                         0.002979     0.000008     0.000015     0.000028     0.000012     0.000009     0.000182     0.003233
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000221     0.000440     0.000661     0.000501     0.000320     0.000241     0.000069     0.002453
Restriction                   0.000019     0.000027     0.003833     0.000082     0.000013     0.000011     0.000000     0.003985
  local restriction           0.000019     0.000026     0.000358     0.000027     0.000011     0.000010     0.000000     0.000450
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000037     0.000000     0.000000     0.000000     0.000037
Interpolation                 0.000115     0.000170     0.000321     0.000208     0.000053     0.000034     0.000000     0.000900
  local interpolation         0.000018     0.000026     0.000225     0.000085     0.000029     0.000013     0.000000     0.000397
  pack MPI buffers            0.000000     0.000000     0.000000     0.000084     0.000000     0.000000     0.000000     0.000084
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
Ghost Zone Exchange           0.000482     0.000932     0.001398     0.000703     0.000009     0.000010     0.000005     0.003538
  local exchange              0.000158     0.000315     0.000473     0.000162     0.000000     0.000000     0.000000     0.001107
  pack MPI buffers            0.000000     0.000000     0.000000     0.000154     0.000000     0.000000     0.000000     0.000154
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000142     0.000000     0.000000     0.000000     0.000142
  MPI_Isend                   0.000017     0.000030     0.000041     0.000046     0.000000     0.000000     0.000000     0.000134
  MPI_Irecv                   0.000103     0.000201     0.000307     0.000080     0.000000     0.000000     0.000000     0.000691
  MPI_Waitall                 0.000149     0.000298     0.000447     0.000079     0.000000     0.000000     0.000000     0.000972
MPI_collectives               0.000095     0.000000     0.000000     0.000000     0.000000     0.000000     0.000009     0.000104
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.003995     0.001711     0.006433     0.003871     0.001135     0.000522     0.000298     0.017964

   Total time in MGBuild      0.074903 seconds
   Total time in MGSolve      0.017976 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.017976  DOF/s=1.167e+08  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018251 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 2 1 1 1 6 8
[pwr05:160995] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:161009][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:161008][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882467.738699] [pwr05:161009:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882467.738708] [pwr05:161008:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[161009] [1] MP INFO mp_init() using IB device: mlx5_2 
[161009] [1] MP INFO mp_init() HCA dev: mlx5_2
[161008] [0] MP INFO mp_init() using IB device: mlx5_0 
[161008] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002634 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[161008] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[161009] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.212159 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000822 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000168 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000142 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000225 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000152 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000121 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000222 seconds)
  Building MPI subcommunicator for level 2... done (0.000034 seconds)
  Building MPI subcommunicator for level 3... done (0.000027 seconds)
  Building MPI subcommunicator for level 4... done (0.000038 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.015734 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.006403 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.008073 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001630 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000492 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.030392 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018195 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019087 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.025355 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015251 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016662 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019609 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015907 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016210 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015894 seconds)

WARMUP TIME: 0.193070


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015900 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016667 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015920 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018492 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026093 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020797 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021805 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016659 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015917 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015906 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016251 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018357 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015918 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016645 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015902 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015902 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018543 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015917 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015948 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016649 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019939 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020553 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016241 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.027756 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015877 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015741 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018005 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022861 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015640 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015624 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015631 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015174 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015186 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015123 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019421 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015178 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015098 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015894 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015097 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015080 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015845 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015204 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015785 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015927 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017200 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015207 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016856 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015140 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015171 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015924 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015088 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015170 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015885 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019121 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016329 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022459 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015207 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021172 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024713 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026210 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015154 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015915 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015130 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015176 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017461 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015139 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015141 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015878 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015133 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023395 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019250 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018330 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015445 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015159 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015169 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015959 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015150 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015146 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015558 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016566 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015159 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016109 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017383 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024721 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015529 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015180 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015180 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014988 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022651 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014928 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016349 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015924 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020375 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016215 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015894 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015895 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016711 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015590 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024852 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015938 seconds)

EXEC_TIME TIME: 1.720730


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000093     0.000184     0.000272     0.002066     0.000618     0.000182     0.000000     0.003415
residual                      0.000015     0.000015     0.000023     0.000297     0.000092     0.000021     0.000011     0.000475
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000028     0.000028
BLAS1                         0.002914     0.000007     0.000014     0.000027     0.000011     0.000009     0.000168     0.003150
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000200     0.000395     0.000598     0.000469     0.000303     0.000228     0.000064     0.002257
Restriction                   0.000018     0.000026     0.003729     0.000073     0.000012     0.000010     0.000000     0.003868
  local restriction           0.000017     0.000025     0.000338     0.000024     0.000010     0.000009     0.000000     0.000423
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000032     0.000000     0.000000     0.000000     0.000032
Interpolation                 0.000106     0.000158     0.000290     0.000197     0.000050     0.000031     0.000000     0.000832
  local interpolation         0.000017     0.000024     0.000196     0.000081     0.000027     0.000012     0.000000     0.000358
  pack MPI buffers            0.000000     0.000000     0.000000     0.000080     0.000000     0.000000     0.000000     0.000080
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000447     0.000863     0.001300     0.000696     0.000008     0.000009     0.000004     0.003328
  local exchange              0.000146     0.000290     0.000439     0.000153     0.000000     0.000000     0.000000     0.001028
  pack MPI buffers            0.000000     0.000000     0.000000     0.000144     0.000000     0.000000     0.000000     0.000144
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000134     0.000000     0.000000     0.000000     0.000134
  MPI_Isend                   0.000016     0.000027     0.000038     0.000044     0.000000     0.000000     0.000000     0.000126
  MPI_Irecv                   0.000096     0.000187     0.000285     0.000071     0.000000     0.000000     0.000000     0.000638
  MPI_Waitall                 0.000138     0.000277     0.000417     0.000114     0.000000     0.000000     0.000000     0.000946
MPI_collectives               0.000113     0.000000     0.000000     0.000000     0.000000     0.000000     0.000008     0.000122
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.003873     0.001573     0.006118     0.003735     0.001082     0.000487     0.000274     0.017143

   Total time in MGBuild      0.075641 seconds
   Total time in MGSolve      0.017154 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.017154  DOF/s=1.223e+08  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015565 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 2 1 1 1 6 8
[pwr05:161052] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:161066][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:161065][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882475.417528] [pwr05:161066:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882475.417532] [pwr05:161065:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[161065] [0] MP INFO mp_init() using IB device: mlx5_0 
[161065] [0] MP INFO mp_init() HCA dev: mlx5_0
[161066] [1] MP INFO mp_init() using IB device: mlx5_2 
[161066] [1] MP INFO mp_init() HCA dev: mlx5_2


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.008764 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[161065] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[161066] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.216839 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000805 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000172 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000392 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000225 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000141 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000112 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000278 seconds)
  Building MPI subcommunicator for level 2... done (0.000033 seconds)
  Building MPI subcommunicator for level 3... done (0.000026 seconds)
  Building MPI subcommunicator for level 4... done (0.000039 seconds)
  Building MPI subcommunicator for level 5... done (0.000022 seconds)
  Building MPI subcommunicator for level 6... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.016364 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.006561 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.007941 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001642 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000492 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.037812 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.023587 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015490 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019240 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024597 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021199 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017711 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015404 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015896 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015851 seconds)

WARMUP TIME: 0.207320


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018318 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017270 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015474 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015118 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015123 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015976 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015209 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019614 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015194 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015190 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015936 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015193 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.019553 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015515 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026650 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015221 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015908 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015147 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015178 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015495 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015190 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015141 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015877 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015180 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015038 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021269 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014929 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014942 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014977 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015177 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015169 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015947 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015174 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015201 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024487 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015191 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015929 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015181 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015191 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015542 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015188 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015198 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015941 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015186 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015218 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015553 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021934 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015949 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015228 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017867 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016350 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015246 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015176 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015941 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015191 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015189 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015514 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015191 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015175 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015964 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015197 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015487 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015152 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015165 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015036 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014926 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014821 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014801 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014828 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020754 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014822 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014878 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015155 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020076 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015575 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015544 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026945 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015485 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015493 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016273 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015477 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015523 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015850 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015489 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015590 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017979 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015509 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015512 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015846 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015517 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015525 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016285 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022144 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015499 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015839 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015502 seconds)

EXEC_TIME TIME: 1.622505


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000087     0.000169     0.000250     0.001951     0.000590     0.000171     0.000000     0.003217
residual                      0.000014     0.000014     0.000021     0.000277     0.000085     0.000020     0.000010     0.000441
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000026     0.000026
BLAS1                         0.002651     0.000006     0.000013     0.000025     0.000011     0.000008     0.000155     0.002869
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000180     0.000361     0.000552     0.000504     0.000286     0.000215     0.000060     0.002159
Restriction                   0.000017     0.000024     0.003589     0.000085     0.000011     0.000009     0.000000     0.003734
  local restriction           0.000016     0.000023     0.000346     0.000021     0.000009     0.000008     0.000000     0.000424
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000006     0.000000     0.000000     0.000000     0.000006
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000049     0.000000     0.000000     0.000000     0.000049
Interpolation                 0.000099     0.000148     0.000279     0.000187     0.000047     0.000028     0.000000     0.000789
  local interpolation         0.000016     0.000023     0.000185     0.000077     0.000026     0.000011     0.000000     0.000338
  pack MPI buffers            0.000000     0.000000     0.000000     0.000076     0.000000     0.000000     0.000000     0.000076
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000423     0.000810     0.001228     0.000724     0.000008     0.000008     0.000004     0.003204
  local exchange              0.000139     0.000272     0.000417     0.000144     0.000000     0.000000     0.000000     0.000971
  pack MPI buffers            0.000000     0.000000     0.000000     0.000134     0.000000     0.000000     0.000000     0.000134
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000127     0.000000     0.000000     0.000000     0.000127
  MPI_Isend                   0.000015     0.000026     0.000036     0.000052     0.000000     0.000000     0.000000     0.000128
  MPI_Irecv                   0.000089     0.000173     0.000266     0.000062     0.000000     0.000000     0.000000     0.000590
  MPI_Waitall                 0.000130     0.000260     0.000393     0.000172     0.000000     0.000000     0.000000     0.000955
MPI_collectives               0.000037     0.000000     0.000000     0.000000     0.000000     0.000000     0.000008     0.000044
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.003470     0.001464     0.005832     0.003660     0.001025     0.000457     0.000253     0.016161

   Total time in MGBuild      0.075342 seconds
   Total time in MGSolve      0.016172 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.016172  DOF/s=1.297e+08  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015502 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 2 1 1 1 6 8
[pwr05:161109] Warning: could not find environment variable "MP_ENABLE_WARN"

# pwr05, Local Rank 0, GPU:/0 CPU:0 HCA:mlx5_0

# pwr05, Local Rank 1, GPU:/2 CPU:8 HCA:mlx5_2
[pwr05:161123][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[pwr05:161122][coll_ml_mca.c:784:hmca_coll_ml_register_params] COLL-ML ATTENTION: Available IPoIB interface was not found. MCAST capability will be disabled.
[1523882483.062605] [pwr05:161123:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_2' is not available
[1523882483.062608] [pwr05:161122:0]    ucp_context.c:539  UCX  WARN  device 'mlx5_0' is not available
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 2 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 0 (Tesla V100-SXM2-16GB)
WARNING: enabling Comm-based communications
[161123] [1] MP INFO mp_init() using IB device: mlx5_2 
[161123] [1] MP INFO mp_init() HCA dev: mlx5_2
[161122] [0] MP INFO mp_init() using IB device: mlx5_0 
[161122] [0] MP INFO mp_init() HCA dev: mlx5_0


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.004207 seconds)
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[161122] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
  calculating D^{-1} exactly for level h=7.812500e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
[161123] GDS WARN  gds_flusher_enabled() GDS_ENABLE_FLUSHER=0
done (0.222815 seconds)
  estimating  lambda_max... <2.223332976448991e+00

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000189 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000196 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000257 seconds)
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000222 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000143 seconds)
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000105 seconds)
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000282 seconds)
  Building MPI subcommunicator for level 2... done (0.000034 seconds)
  Building MPI subcommunicator for level 3... done (0.000026 seconds)
  Building MPI subcommunicator for level 4... done (0.000037 seconds)
  Building MPI subcommunicator for level 5... done (0.000023 seconds)
  Building MPI subcommunicator for level 6... done (0.000022 seconds)

  calculating D^{-1} exactly for level h=1.562500e-02 using 64 colors...  done (0.016358 seconds)
  estimating  lambda_max... <2.223387382550026e+00
  calculating D^{-1} exactly for level h=3.125000e-02 using 64 colors...  done (0.006315 seconds)
  estimating  lambda_max... <2.223793919672764e+00
  calculating D^{-1} exactly for level h=6.250000e-02 using 64 colors...  done (0.008178 seconds)
  estimating  lambda_max... <2.226274209954397e+00
  calculating D^{-1} exactly for level h=1.250000e-01 using 64 colors...  done (0.001642 seconds)
  estimating  lambda_max... <2.230456244630961e+00
  calculating D^{-1} exactly for level h=2.500000e-01 using 64 colors...  done (0.000497 seconds)
  estimating  lambda_max... <2.232895109306462e+00
  calculating D^{-1} exactly for level h=5.000000e-01 using 8 colors...  done (0.000054 seconds)
  estimating  lambda_max... <1.375886524822695e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.033164 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015126 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015431 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015433 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015113 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.028466 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015138 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015075 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015483 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015059 seconds)

WARMUP TIME: 0.184003


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015092 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015865 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015109 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015272 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026522 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015194 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017174 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016159 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015145 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015159 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020801 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015166 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015153 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.026356 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015187 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015972 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017209 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024243 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015191 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015954 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015205 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015178 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015511 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015169 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021930 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015042 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015200 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022738 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014909 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016004 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.014933 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015011 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.017534 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015877 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016705 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015896 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.024227 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018907 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015881 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015899 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016626 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015874 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015895 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016248 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021516 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016668 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015882 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.020366 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016279 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016688 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.018783 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016660 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015869 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015913 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016240 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015899 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015891 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016652 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015868 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016356 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016270 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015911 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015889 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016630 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015893 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015884 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015730 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.022340 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015715 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.021079 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016769 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015617 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015130 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015177 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015169 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015579 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015592 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015636 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016328 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015579 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015578 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015917 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015585 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015568 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016331 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015575 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015567 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015935 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015582 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015583 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016332 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015572 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015585 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015930 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015576 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015578 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.016355 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015583 seconds)
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015584 seconds)

EXEC_TIME TIME: 1.669987


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  128^3         64^3         32^3         16^3          8^3          4^3          2^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000094     0.000183     0.000275     0.002010     0.000617     0.000185     0.000000     0.003363
residual                      0.000015     0.000015     0.000023     0.000300     0.000094     0.000022     0.000011     0.000481
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000028     0.000028
BLAS1                         0.002596     0.000007     0.000014     0.000027     0.000012     0.000009     0.000170     0.002834
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000202     0.000400     0.000601     0.000473     0.000304     0.000228     0.000065     0.002273
Restriction                   0.000018     0.000025     0.003479     0.000086     0.000012     0.000010     0.000000     0.003630
  local restriction           0.000017     0.000025     0.000348     0.000024     0.000010     0.000009     0.000000     0.000434
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000008     0.000000     0.000000     0.000000     0.000008
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000044     0.000000     0.000000     0.000000     0.000044
Interpolation                 0.000108     0.000159     0.000314     0.000199     0.000050     0.000031     0.000000     0.000861
  local interpolation         0.000017     0.000025     0.000216     0.000082     0.000027     0.000012     0.000000     0.000379
  pack MPI buffers            0.000000     0.000000     0.000000     0.000080     0.000000     0.000000     0.000000     0.000080
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000005     0.000000     0.000000     0.000000     0.000005
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000004     0.000000     0.000000     0.000000     0.000004
Ghost Zone Exchange           0.000448     0.000938     0.001308     0.000751     0.000008     0.000009     0.000004     0.003467
  local exchange              0.000148     0.000293     0.000445     0.000153     0.000000     0.000000     0.000000     0.001039
  pack MPI buffers            0.000000     0.000000     0.000000     0.000145     0.000000     0.000000     0.000000     0.000145
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000135     0.000000     0.000000     0.000000     0.000135
  MPI_Isend                   0.000016     0.000027     0.000038     0.000054     0.000000     0.000000     0.000000     0.000134
  MPI_Irecv                   0.000096     0.000258     0.000287     0.000072     0.000000     0.000000     0.000000     0.000713
  MPI_Waitall                 0.000140     0.000278     0.000418     0.000155     0.000000     0.000000     0.000000     0.000991
MPI_collectives               0.000028     0.000000     0.000000     0.000000     0.000000     0.000000     0.000008     0.000036
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.003474     0.001652     0.005907     0.003749     0.001085     0.000491     0.000277     0.016635

   Total time in MGBuild      0.076300 seconds
   Total time in MGSolve      0.016646 seconds
      number of v-cycles             1
Bottom solver iterations            12




===== Performance Summary ======================================================
  h=7.812500000000000e-03  DOF=2.097152000000000e+06  time=0.016646  DOF/s=1.260e+08  MPI=2  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=7.454823493735496e-06  rel=7.517923675788369e-06  done (0.015564 seconds)
  h=7.812500000000000e-03  ||error||=3.069591062680318e-03
  order=-16.364


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1
