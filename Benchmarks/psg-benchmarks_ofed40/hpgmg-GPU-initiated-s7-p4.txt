./run.sh 4 1 1 1 7 8
[hsw218:52223] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[26234] [1] MP INFO mp_init() using IB device: mlx5_0 
[26234] [1] MP INFO mp_init() HCA dev: mlx5_0
[25380] [3] MP INFO mp_init() using IB device: mlx5_0 
[25380] [3] MP INFO mp_init() HCA dev: mlx5_0
[52250] [0] MP INFO mp_init() using IB device: mlx5_0 
[52250] [0] MP INFO mp_init() HCA dev: mlx5_0
[23958] [2] MP INFO mp_init() using IB device: mlx5_0 
[23958] [2] MP INFO mp_init() HCA dev: mlx5_0
[26234] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6850 for QP
[26234] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6850 for QP
[25380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294890 for QP
[25380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294890 for QP
[52250] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabfb39e10 for QP
[52250] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabfb39e10 for QP
[26234] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf0fa0 for QP
[26234] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf0fa0 for QP
[23958] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294e30 for QP
[23958] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294e30 for QP
[25380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcf50 for QP
[25380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcf50 for QP
[52250] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae485e550 for QP
[52250] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae485e550 for QP
[26234] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe528f80 for QP
[26234] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe528f80 for QP
[23958] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc0630 for QP
[23958] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc0630 for QP
[25380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6f00 for QP
[25380] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6f00 for QP
[52250] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4888500 for QP
[52250] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4888500 for QP
[23958] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cea5d0 for QP
[23958] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cea5d0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.107643 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.540150 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.016366 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002744 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000948 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000322 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000118 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000670 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000145 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001294 seconds)
  Building MPI subcommunicator for level 2... done (0.000047 seconds)
  Building MPI subcommunicator for level 3... done (0.000042 seconds)
  Building MPI subcommunicator for level 4... done (0.000030 seconds)
  Building MPI subcommunicator for level 5... done (0.000030 seconds)
  Building MPI subcommunicator for level 6... done (0.000036 seconds)
  Building MPI subcommunicator for level 7... done (0.000035 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.127342 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.035524 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012228 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011433 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003235 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002401 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.221170 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126198 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128050 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127756 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127140 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125541 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130401 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127267 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128825 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130328 seconds)

WARMUP TIME: 1.373299


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126401 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125749 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127913 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126943 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126733 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130646 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127630 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127796 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127968 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127920 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125971 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127733 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127020 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125972 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126950 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128993 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128755 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128074 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128153 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125986 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125679 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127020 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126454 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127068 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127274 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127010 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127156 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128501 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128888 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127659 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127389 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127742 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126558 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128547 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126932 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127286 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127096 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128106 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126465 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127688 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126959 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127975 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128210 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126547 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126405 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126590 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126845 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127014 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128191 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125428 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128059 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127268 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126131 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126497 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126406 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128640 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128520 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125448 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126803 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126524 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126446 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126506 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125639 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125619 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125923 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127158 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126655 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126682 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127298 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128503 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127368 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127072 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126837 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127626 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129660 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126441 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128602 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125420 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126536 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127766 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125780 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129101 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127550 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126895 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127202 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128644 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128078 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126546 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126995 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128033 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125937 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126476 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127839 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127966 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127473 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126165 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125328 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126107 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125828 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129130 seconds)

EXEC_TIME TIME: 12.725107


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000050     0.000097     0.000146     0.000193     0.003413     0.000629     0.000152     0.000000     0.004680
residual                      0.000009     0.000009     0.000013     0.000017     0.000460     0.000079     0.000019     0.000008     0.000614
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041294     0.000004     0.000007     0.000011     0.000032     0.000013     0.000010     0.000032     0.041403
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000118     0.000232     0.000343     0.000464     0.000627     0.000305     0.000211     0.000042     0.002340
Restriction                   0.000012     0.000015     0.000021     0.062797     0.000025     0.000085     0.000071     0.000000     0.063025
  local restriction           0.000011     0.000014     0.000019     0.001258     0.000023     0.000005     0.000003     0.000000     0.001332
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000015     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000064     0.000048     0.000000     0.000112
Interpolation                 0.000138     0.000193     0.000237     0.000457     0.000238     0.000200     0.000935     0.000000     0.002398
  local interpolation         0.000009     0.000014     0.000019     0.000275     0.000110     0.000018     0.000006     0.000000     0.000452
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000025     0.000016     0.000000     0.000041
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000051     0.000893     0.000000     0.000944
Ghost Zone Exchange           0.000918     0.001757     0.002575     0.003283     0.001978     0.001605     0.000963     0.000005     0.013083
  local exchange              0.000078     0.000157     0.000232     0.000334     0.000259     0.000075     0.000067     0.000000     0.001203
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000183     0.000075     0.000061     0.000000     0.000319
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000242     0.000081     0.000072     0.000000     0.000395
  MPI_Isend                   0.000091     0.000193     0.000309     0.000417     0.000265     0.000530     0.000179     0.000000     0.001984
  MPI_Irecv                   0.000245     0.000509     0.000818     0.001041     0.000244     0.000254     0.000168     0.000000     0.003280
  MPI_Waitall                 0.000133     0.000266     0.000398     0.000560     0.000752     0.000555     0.000383     0.000000     0.003046
MPI_collectives               0.000231     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000194     0.000425
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042724     0.002197     0.003189     0.067057     0.006588     0.002803     0.002274     0.000333     0.127164

   Total time in MGBuild      0.458171 seconds
   Total time in MGSolve      0.127182 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.127182  DOF/s=4.452e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127678 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw218:52271] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0



# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[26277] [1] MP INFO mp_init() using IB device: mlx5_0 
[26277] [1] MP INFO mp_init() HCA dev: mlx5_0
[25416] [3] MP INFO mp_init() using IB device: mlx5_0 
[25416] [3] MP INFO mp_init() HCA dev: mlx5_0
[24002] [2] MP INFO mp_init() using IB device: mlx5_0 
[24002] [2] MP INFO mp_init() HCA dev: mlx5_0
[26277] GDS WARN  gds_create_qp() using peer res_domain 0xf9a890 for QP
[26277] GDS WARN  gds_create_qp() using peer res_domain 0xf9a890 for QP
[25416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294910 for QP
[25416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294910 for QP
[24002] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabfb39cb0 for QP
[24002] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabfb39cb0 for QP
[26277] GDS WARN  gds_create_qp() using peer res_domain 0x2ab6890 for QP
[26277] GDS WARN  gds_create_qp() using peer res_domain 0x2ab6890 for QP
[25416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcff0 for QP
[25416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcff0 for QP
[24002] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae48610c0 for QP
[24002] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae48610c0 for QP
[26277] GDS WARN  gds_create_qp() using peer res_domain 0x2ae0840 for QP
[26277] GDS WARN  gds_create_qp() using peer res_domain 0x2ae0840 for QP
[25416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6f90 for QP
[25416] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6f90 for QP
[24002] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae488b0a0 for QP
[24002] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae488b0a0 for QP
[52298] [0] MP INFO mp_init() using IB device: mlx5_0 
[52298] [0] MP INFO mp_init() HCA dev: mlx5_0
[52298] GDS WARN  gds_create_qp() using peer res_domain 0xeac4e0 for QP
[52298] GDS WARN  gds_create_qp() using peer res_domain 0xeac4e0 for QP
[52298] GDS WARN  gds_create_qp() using peer res_domain 0x29c8250 for QP
[52298] GDS WARN  gds_create_qp() using peer res_domain 0x29c8250 for QP
[52298] GDS WARN  gds_create_qp() using peer res_domain 0x29f2200 for QP
[52298] GDS WARN  gds_create_qp() using peer res_domain 0x29f2200 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.105781 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.493306 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.016265 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002733 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001001 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000383 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000141 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000689 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000142 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000744 seconds)
  Building MPI subcommunicator for level 2... done (0.000051 seconds)
  Building MPI subcommunicator for level 3... done (0.000034 seconds)
  Building MPI subcommunicator for level 4... done (0.000030 seconds)
  Building MPI subcommunicator for level 5... done (0.000028 seconds)
  Building MPI subcommunicator for level 6... done (0.000028 seconds)
  Building MPI subcommunicator for level 7... done (0.000034 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.127237 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036010 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012838 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010810 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003322 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002490 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.221524 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129240 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126783 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127989 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129942 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128645 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128327 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131188 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131664 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126904 seconds)

WARMUP TIME: 1.382863


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127675 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128172 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128270 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128548 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127860 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130045 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128789 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127700 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127379 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129965 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126913 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126405 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130396 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126947 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132332 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129532 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128909 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128932 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129972 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129002 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128704 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128136 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129970 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127708 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129077 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128035 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127804 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129097 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128916 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132911 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130975 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127880 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129006 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130171 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126044 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130235 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128595 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128622 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130039 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127900 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129705 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128750 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128284 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130022 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129947 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129674 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130132 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127542 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129330 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127339 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130530 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128027 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128909 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127896 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128817 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130058 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128967 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127898 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129999 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127917 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128916 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127137 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130749 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128981 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129895 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126916 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128971 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127928 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127833 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127415 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128720 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128605 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130072 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131021 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126835 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129048 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128927 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127413 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128365 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129078 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.132016 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127806 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127592 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128326 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126553 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130331 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127837 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130890 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129115 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127234 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130554 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129145 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127613 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129096 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128092 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128814 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131760 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127108 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126732 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127183 seconds)

EXEC_TIME TIME: 12.885936


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000095     0.000142     0.000190     0.003468     0.000634     0.000168     0.000000     0.004745
residual                      0.000008     0.000008     0.000012     0.000016     0.000470     0.000077     0.000019     0.000008     0.000619
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041267     0.000004     0.000007     0.000011     0.000033     0.000012     0.000013     0.000030     0.041377
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000119     0.000238     0.000350     0.000478     0.000665     0.000340     0.000242     0.000047     0.002479
Restriction                   0.000011     0.000015     0.000020     0.062926     0.000023     0.000309     0.000071     0.000000     0.063375
  local restriction           0.000010     0.000014     0.000019     0.001262     0.000021     0.000006     0.000003     0.000000     0.001335
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000011     0.000015     0.000000     0.000026
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000288     0.000047     0.000000     0.000335
Interpolation                 0.000137     0.000190     0.000233     0.000449     0.000235     0.000162     0.002303     0.000000     0.003708
  local interpolation         0.000009     0.000014     0.000019     0.000265     0.000112     0.000019     0.000005     0.000000     0.000444
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000010     0.000000     0.000016
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000019     0.000015     0.000000     0.000034
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000014     0.002258     0.000000     0.002272
Ghost Zone Exchange           0.000904     0.001736     0.002541     0.003240     0.002010     0.001439     0.000980     0.000005     0.012854
  local exchange              0.000077     0.000153     0.000227     0.000329     0.000273     0.000090     0.000085     0.000000     0.001234
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000200     0.000094     0.000070     0.000000     0.000364
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000266     0.000107     0.000080     0.000000     0.000453
  MPI_Isend                   0.000088     0.000188     0.000302     0.000408     0.000333     0.000480     0.000180     0.000000     0.001979
  MPI_Irecv                   0.000240     0.000502     0.000809     0.001031     0.000243     0.000248     0.000169     0.000000     0.003242
  MPI_Waitall                 0.000129     0.000260     0.000388     0.000543     0.000662     0.000386     0.000362     0.000000     0.002730
MPI_collectives               0.000235     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000179     0.000414
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042685     0.002176     0.003154     0.067149     0.006718     0.002869     0.003701     0.000319     0.128770

   Total time in MGBuild      0.459340 seconds
   Total time in MGSolve      0.128788 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.128788  DOF/s=4.397e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128695 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw218:52328] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[26314] [1] MP INFO mp_init() using IB device: mlx5_0 
[26314] [1] MP INFO mp_init() HCA dev: mlx5_0
[25456] [3] MP INFO mp_init() using IB device: mlx5_0 
[25456] [3] MP INFO mp_init() HCA dev: mlx5_0
[24040] [2] MP INFO mp_init() using IB device: mlx5_0 
[24040] [2] MP INFO mp_init() HCA dev: mlx5_0
[26314] GDS WARN  gds_create_qp() using peer res_domain 0xf9ae00 for QP
[26314] GDS WARN  gds_create_qp() using peer res_domain 0xf9ae00 for QP
[25456] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2b43c0 for QP
[25456] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2b43c0 for QP
[52355] [0] MP INFO mp_init() using IB device: mlx5_0 
[52355] [0] MP INFO mp_init() HCA dev: mlx5_0
[24040] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c61d0 for QP
[24040] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c61d0 for QP
[26314] GDS WARN  gds_create_qp() using peer res_domain 0x2ab6ea0 for QP
[26314] GDS WARN  gds_create_qp() using peer res_domain 0x2ab6ea0 for QP
[25456] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cd4b50 for QP
[25456] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cd4b50 for QP
[52355] GDS WARN  gds_create_qp() using peer res_domain 0xf7cfd0 for QP
[52355] GDS WARN  gds_create_qp() using peer res_domain 0xf7cfd0 for QP
[24040] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cee8c0 for QP
[24040] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cee8c0 for QP
[25456] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cfeb00 for QP
[25456] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cfeb00 for QP
[26314] GDS WARN  gds_create_qp() using peer res_domain 0x2ae0e50 for QP
[26314] GDS WARN  gds_create_qp() using peer res_domain 0x2ae0e50 for QP
[52355] GDS WARN  gds_create_qp() using peer res_domain 0x2a99070 for QP
[52355] GDS WARN  gds_create_qp() using peer res_domain 0x2a99070 for QP
[24040] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe5198e0 for QP
[24040] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe5198e0 for QP
[52355] GDS WARN  gds_create_qp() using peer res_domain 0x2ac3010 for QP
[52355] GDS WARN  gds_create_qp() using peer res_domain 0x2ac3010 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.109086 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.525606 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.016093 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002852 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000959 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000192 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000129 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000679 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000135 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000822 seconds)
  Building MPI subcommunicator for level 2... done (0.000055 seconds)
  Building MPI subcommunicator for level 3... done (0.000035 seconds)
  Building MPI subcommunicator for level 4... done (0.000029 seconds)
  Building MPI subcommunicator for level 5... done (0.000029 seconds)
  Building MPI subcommunicator for level 6... done (0.000029 seconds)
  Building MPI subcommunicator for level 7... done (0.000034 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.127945 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.035924 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012302 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.012043 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003321 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002407 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.222093 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127389 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126913 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126684 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126191 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127875 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129382 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127064 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126434 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127109 seconds)

WARMUP TIME: 1.367815


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127661 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128935 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127177 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126350 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127314 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127224 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127430 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127146 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127185 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126417 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126032 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127019 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129304 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127370 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129164 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127166 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125983 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127204 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126682 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127724 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126374 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128102 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126555 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126022 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126830 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127518 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126665 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126889 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126416 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125518 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127420 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126880 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126566 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126858 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126247 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126356 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127973 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125875 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127043 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127901 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127947 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126434 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128078 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127101 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126697 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127270 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125334 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125867 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127723 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126800 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127044 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126797 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126245 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126954 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125786 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125618 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126318 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125451 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127761 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128286 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125676 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126312 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129214 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126732 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126559 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126536 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126898 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127844 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127105 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125352 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127588 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126088 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126509 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127110 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127470 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126972 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128482 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126892 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128660 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127191 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126190 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125657 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126752 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127993 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125659 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128545 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128799 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127184 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127742 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128647 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125564 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126799 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126557 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126759 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127408 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126582 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127145 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127718 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125886 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125421 seconds)

EXEC_TIME TIME: 12.704190


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000095     0.000143     0.000193     0.003399     0.000682     0.000170     0.000000     0.004728
residual                      0.000009     0.000008     0.000012     0.000016     0.000458     0.000081     0.000020     0.000008     0.000612
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041284     0.000004     0.000008     0.000011     0.000032     0.000014     0.000013     0.000031     0.041396
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000118     0.000234     0.000347     0.000471     0.000622     0.000334     0.000217     0.000044     0.002387
Restriction                   0.000011     0.000015     0.000021     0.062875     0.000025     0.000088     0.000074     0.000000     0.063108
  local restriction           0.000011     0.000014     0.000020     0.001269     0.000023     0.000006     0.000003     0.000000     0.001343
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000002     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000016     0.000000     0.000028
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000067     0.000050     0.000000     0.000117
Interpolation                 0.000138     0.000192     0.000237     0.000460     0.000235     0.000150     0.000574     0.000000     0.001986
  local interpolation         0.000009     0.000014     0.000018     0.000269     0.000111     0.000019     0.000005     0.000000     0.000445
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000015     0.000016     0.000000     0.000031
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000013     0.000532     0.000000     0.000545
Ghost Zone Exchange           0.000918     0.001750     0.002577     0.003279     0.002063     0.001596     0.000923     0.000004     0.013110
  local exchange              0.000079     0.000156     0.000236     0.000335     0.000258     0.000107     0.000076     0.000000     0.001248
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000182     0.000079     0.000064     0.000000     0.000325
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000244     0.000119     0.000076     0.000000     0.000439
  MPI_Isend                   0.000088     0.000187     0.000302     0.000408     0.000315     0.000686     0.000178     0.000000     0.002164
  MPI_Irecv                   0.000244     0.000505     0.000816     0.001036     0.000243     0.000258     0.000176     0.000000     0.003278
  MPI_Waitall                 0.000133     0.000266     0.000402     0.000564     0.000789     0.000314     0.000319     0.000000     0.002788
MPI_collectives               0.000237     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000192     0.000430
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042719     0.002189     0.003191     0.067139     0.006642     0.002838     0.001903     0.000332     0.126953

   Total time in MGBuild      0.459642 seconds
   Total time in MGSolve      0.126971 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.126971  DOF/s=4.460e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125450 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw218:52378] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0



# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[26361] [1] MP INFO mp_init() using IB device: mlx5_0 
[26361] [1] MP INFO mp_init() HCA dev: mlx5_0
[25500] [3] MP INFO mp_init() using IB device: mlx5_0 
[25500] [3] MP INFO mp_init() HCA dev: mlx5_0
[24078] [2] MP INFO mp_init() using IB device: mlx5_0 
[24078] [2] MP INFO mp_init() HCA dev: mlx5_0
[26361] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6670 for QP
[26361] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6670 for QP
[52405] [0] MP INFO mp_init() using IB device: mlx5_0 
[52405] [0] MP INFO mp_init() HCA dev: mlx5_0
[25500] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4879d0 for QP
[25500] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4879d0 for QP
[24078] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe0e8850 for QP
[24078] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe0e8850 for QP
[26361] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf0aa0 for QP
[26361] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf0aa0 for QP
[52405] GDS WARN  gds_create_qp() using peer res_domain 0xe8f740 for QP
[52405] GDS WARN  gds_create_qp() using peer res_domain 0xe8f740 for QP
[25500] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4faed70 for QP
[25500] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4faed70 for QP
[26361] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe529aa0 for QP
[26361] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe529aa0 for QP
[24078] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe316f80 for QP
[24078] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe316f80 for QP
[52405] GDS WARN  gds_create_qp() using peer res_domain 0x29ab3f0 for QP
[52405] GDS WARN  gds_create_qp() using peer res_domain 0x29ab3f0 for QP
[25500] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fd8d10 for QP
[25500] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fd8d10 for QP
[24078] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe340f60 for QP
[24078] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe340f60 for QP
[52405] GDS WARN  gds_create_qp() using peer res_domain 0x29d5390 for QP
[52405] GDS WARN  gds_create_qp() using peer res_domain 0x29d5390 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.107634 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.557450 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.014081 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002991 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000877 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000342 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000171 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000673 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000135 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001416 seconds)
  Building MPI subcommunicator for level 2... done (0.000046 seconds)
  Building MPI subcommunicator for level 3... done (0.000032 seconds)
  Building MPI subcommunicator for level 4... done (0.000029 seconds)
  Building MPI subcommunicator for level 5... done (0.000029 seconds)
  Building MPI subcommunicator for level 6... done (0.000032 seconds)
  Building MPI subcommunicator for level 7... done (0.000046 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.127040 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.036430 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012075 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011761 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003369 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002437 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000057 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.224801 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126356 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126366 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128972 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128276 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126442 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128173 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127048 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126621 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129492 seconds)

WARMUP TIME: 1.373106


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128029 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126617 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127818 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127226 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127644 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128072 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127874 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127958 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125740 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127409 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126150 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126664 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126573 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127171 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127027 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126674 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126991 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126554 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127416 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129064 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128170 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127233 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126677 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127053 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130175 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127613 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127337 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127298 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127892 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126939 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126507 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130847 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127450 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127912 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128023 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126773 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127841 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127323 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127782 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128334 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127832 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126727 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129924 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125827 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127851 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128148 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125584 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127058 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128159 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126978 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126745 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126159 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126801 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127999 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126917 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126483 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126686 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126630 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126885 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.137579 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126359 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127525 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126481 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128675 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127063 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126750 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126018 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126290 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127528 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128213 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130370 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127169 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126528 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127212 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127917 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127679 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126937 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126247 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126360 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127787 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130018 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126909 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128025 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126525 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129380 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128033 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126089 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125679 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126546 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125729 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125697 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126815 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126281 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126656 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125879 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126073 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127734 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126716 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125809 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128711 seconds)

EXEC_TIME TIME: 12.743359


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000047     0.000095     0.000144     0.000187     0.003402     0.000690     0.000169     0.000000     0.004734
residual                      0.000008     0.000008     0.000012     0.000016     0.000460     0.000080     0.000019     0.000008     0.000614
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041284     0.000004     0.000008     0.000011     0.000032     0.000014     0.000012     0.000030     0.041395
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000118     0.000233     0.000345     0.000464     0.000622     0.000332     0.000214     0.000043     0.002371
Restriction                   0.000011     0.000015     0.000021     0.062996     0.000026     0.000096     0.000070     0.000000     0.063236
  local restriction           0.000011     0.000014     0.000019     0.001260     0.000023     0.000005     0.000003     0.000000     0.001336
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000016     0.000000     0.000028
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000075     0.000047     0.000000     0.000122
Interpolation                 0.000139     0.000193     0.000239     0.000441     0.000257     0.000150     0.000842     0.000000     0.002262
  local interpolation         0.000009     0.000014     0.000019     0.000264     0.000111     0.000020     0.000005     0.000000     0.000442
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000014     0.000016     0.000000     0.000030
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000800     0.000000     0.000812
Ghost Zone Exchange           0.000920     0.001757     0.002580     0.003264     0.002074     0.001556     0.000960     0.000004     0.013115
  local exchange              0.000080     0.000161     0.000239     0.000337     0.000257     0.000109     0.000073     0.000000     0.001256
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000184     0.000081     0.000065     0.000000     0.000329
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000246     0.000124     0.000075     0.000000     0.000445
  MPI_Isend                   0.000089     0.000190     0.000304     0.000407     0.000348     0.000502     0.000178     0.000000     0.002018
  MPI_Irecv                   0.000246     0.000509     0.000822     0.001039     0.000246     0.000263     0.000172     0.000000     0.003296
  MPI_Waitall                 0.000133     0.000265     0.000397     0.000551     0.000761     0.000442     0.000363     0.000000     0.002912
MPI_collectives               0.000239     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000196     0.000436
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042721     0.002195     0.003196     0.067212     0.006694     0.002788     0.002199     0.000335     0.127341

   Total time in MGBuild      0.459603 seconds
   Total time in MGSolve      0.127359 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.127359  DOF/s=4.446e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126954 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1


===========================================================================

./run.sh 4 1 1 1 7 8
[hsw218:52439] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[25543] [3] MP INFO mp_init() using IB device: mlx5_0 
[25543] [3] MP INFO mp_init() HCA dev: mlx5_0
[26401] [1] MP INFO mp_init() using IB device: mlx5_0 
[26401] [1] MP INFO mp_init() HCA dev: mlx5_0
[24126] [2] MP INFO mp_init() using IB device: mlx5_0 
[24126] [2] MP INFO mp_init() HCA dev: mlx5_0
[25543] GDS WARN  gds_create_qp() using peer res_domain 0xeae950 for QP
[25543] GDS WARN  gds_create_qp() using peer res_domain 0xeae950 for QP
[52466] [0] MP INFO mp_init() using IB device: mlx5_0 
[52466] [0] MP INFO mp_init() HCA dev: mlx5_0
[26401] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6010 for QP
[26401] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6010 for QP
[24126] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2a2150 for QP
[24126] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2a2150 for QP
[25543] GDS WARN  gds_create_qp() using peer res_domain 0x29ca9f0 for QP
[25543] GDS WARN  gds_create_qp() using peer res_domain 0x29ca9f0 for QP
[26401] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cee7c0 for QP
[26401] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cee7c0 for QP
[52466] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2872b0 for QP
[52466] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2872b0 for QP
[24126] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc68c0 for QP
[24126] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc68c0 for QP
[25543] GDS WARN  gds_create_qp() using peer res_domain 0x29f4990 for QP
[25543] GDS WARN  gds_create_qp() using peer res_domain 0x29f4990 for QP
[26401] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe5197d0 for QP
[26401] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe5197d0 for QP
[52466] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cb29e0 for QP
[52466] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cb29e0 for QP
[24126] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf08a0 for QP
[24126] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf08a0 for QP
[52466] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cdc990 for QP
[52466] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cdc990 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 384^3 level from 27 x 128^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.104480 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=2.604167e-03 using 64 colors...  WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: enabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (2.574976 seconds)
  estimating  lambda_max... <2.223325356567668e+00

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.014349 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002487 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000826 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000267 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000106 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000680 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000145 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.001207 seconds)
  Building MPI subcommunicator for level 2... done (0.000051 seconds)
  Building MPI subcommunicator for level 3... done (0.000032 seconds)
  Building MPI subcommunicator for level 4... done (0.000031 seconds)
  Building MPI subcommunicator for level 5... done (0.000032 seconds)
  Building MPI subcommunicator for level 6... done (0.000034 seconds)
  Building MPI subcommunicator for level 7... done (0.000034 seconds)

  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  done (0.126871 seconds)
  estimating  lambda_max... <2.223327414050833e+00
  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.035978 seconds)
  estimating  lambda_max... <2.223343744583469e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012658 seconds)
  estimating  lambda_max... <2.223470419163737e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011682 seconds)
  estimating  lambda_max... <2.224369200203498e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003370 seconds)
  estimating  lambda_max... <2.228709356185495e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002425 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.222932 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125796 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125373 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130683 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127007 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126152 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127986 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126721 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128953 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127726 seconds)

WARMUP TIME: 1.369995


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128481 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126280 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129141 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127912 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130611 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127362 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126666 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127120 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125859 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127247 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127799 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127533 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127264 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127932 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128416 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128787 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126590 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128317 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129378 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127816 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127092 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130725 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.131553 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126874 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128769 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129529 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126571 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128389 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129252 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126966 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128749 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127006 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126024 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130124 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128040 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127522 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127183 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127755 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126800 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129405 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127590 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128990 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129014 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126856 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127233 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129854 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128844 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126717 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127215 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126876 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128174 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127513 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126283 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126512 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127264 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126671 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127274 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127854 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128311 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127517 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126775 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126190 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126706 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126418 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.130028 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127950 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126632 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126625 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126990 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127690 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127062 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127966 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128082 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128608 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128774 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126636 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129774 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126268 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126423 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128110 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126001 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126458 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126331 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129902 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127332 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126846 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128620 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127034 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128906 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126799 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126951 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128253 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127400 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127306 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126086 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.128786 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126753 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.126090 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.125798 seconds)
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.127432 seconds)

EXEC_TIME TIME: 12.774472


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6              7   
level dimension                  384^3        192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            1            0            0            0            0   
box dimension                    128^3         64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000049     0.000095     0.000145     0.000193     0.003400     0.000668     0.000154     0.000000     0.004704
residual                      0.000009     0.000008     0.000013     0.000016     0.000458     0.000079     0.000019     0.000009     0.000611
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000037
BLAS1                         0.041280     0.000004     0.000007     0.000011     0.000032     0.000014     0.000009     0.000031     0.041388
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000118     0.000233     0.000344     0.000464     0.000623     0.000318     0.000211     0.000042     0.002353
Restriction                   0.000012     0.000015     0.000021     0.062759     0.000025     0.000086     0.000073     0.000000     0.062990
  local restriction           0.000011     0.000014     0.000020     0.001261     0.000023     0.000005     0.000003     0.000000     0.001336
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000012     0.000015     0.000000     0.000027
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000064     0.000050     0.000000     0.000115
Interpolation                 0.000139     0.000195     0.000238     0.000449     0.000238     0.000203     0.000984     0.000000     0.002445
  local interpolation         0.000010     0.000014     0.000019     0.000272     0.000111     0.000020     0.000005     0.000000     0.000451
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000009     0.000000     0.000015
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000016     0.000016     0.000000     0.000032
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000066     0.000942     0.000000     0.001008
Ghost Zone Exchange           0.000931     0.001776     0.002605     0.003332     0.002064     0.001890     0.000932     0.000005     0.013535
  local exchange              0.000081     0.000161     0.000241     0.000347     0.000258     0.000095     0.000068     0.000000     0.001252
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000180     0.000077     0.000059     0.000000     0.000317
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000245     0.000102     0.000069     0.000000     0.000416
  MPI_Isend                   0.000092     0.000195     0.000310     0.000421     0.000315     0.000866     0.000169     0.000000     0.002368
  MPI_Irecv                   0.000246     0.000511     0.000820     0.001045     0.000247     0.000259     0.000168     0.000000     0.003296
  MPI_Waitall                 0.000133     0.000266     0.000400     0.000563     0.000787     0.000456     0.000365     0.000000     0.002971
MPI_collectives               0.000226     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000200     0.000426
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000002
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.042716     0.002216     0.003218     0.067058     0.006663     0.003144     0.002300     0.000339     0.127653

   Total time in MGBuild      0.457117 seconds
   Total time in MGSolve      0.127672 seconds
      number of v-cycles             1
Bottom solver iterations            26




===== Performance Summary ======================================================
  h=2.604166666666667e-03  DOF=5.662310400000000e+07  time=0.127672  DOF/s=4.435e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.045704890872967e-07  rel=1.046685172112177e-07  done (0.129447 seconds)
  h=2.604166666666667e-03  ||error||=3.116860953292001e-03
  order=-25.124


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done
attempting to free the   384^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=1
