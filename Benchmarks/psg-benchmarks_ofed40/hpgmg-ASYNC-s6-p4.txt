./run.sh 4 1 1 0 6 8
[hsw218:48768] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[23164] [3] MP INFO mp_init() using IB device: mlx5_0 
[23164] [3] MP INFO mp_init() HCA dev: mlx5_0
[23721] [1] MP INFO mp_init() using IB device: mlx5_0 
[23721] [1] MP INFO mp_init() HCA dev: mlx5_0
[21737] [2] MP INFO mp_init() using IB device: mlx5_0 
[21737] [2] MP INFO mp_init() HCA dev: mlx5_0
[48795] [0] MP INFO mp_init() using IB device: mlx5_0 
[48795] [0] MP INFO mp_init() HCA dev: mlx5_0
[23164] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4b4890 for QP
[23164] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe4b4890 for QP
[23721] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494a10 for QP
[23721] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494a10 for QP
[21737] GDS WARN  gds_create_qp() using peer res_domain 0xead410 for QP
[21737] GDS WARN  gds_create_qp() using peer res_domain 0xead410 for QP
[48795] GDS WARN  gds_create_qp() using peer res_domain 0xf99050 for QP
[48795] GDS WARN  gds_create_qp() using peer res_domain 0xf99050 for QP
[23164] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fd7c60 for QP
[23164] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fd7c60 for QP
[23721] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbcd00 for QP
[23721] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbcd00 for QP
[21737] GDS WARN  gds_create_qp() using peer res_domain 0x29c90c0 for QP
[21737] GDS WARN  gds_create_qp() using peer res_domain 0x29c90c0 for QP
[48795] GDS WARN  gds_create_qp() using peer res_domain 0x2ab4d10 for QP
[48795] GDS WARN  gds_create_qp() using peer res_domain 0x2ab4d10 for QP
[23164] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1402c50 for QP
[23164] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae1402c50 for QP
[23721] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe6ce0 for QP
[23721] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe6ce0 for QP
[21737] GDS WARN  gds_create_qp() using peer res_domain 0x29f30a0 for QP
[21737] GDS WARN  gds_create_qp() using peer res_domain 0x29f30a0 for QP
[48795] GDS WARN  gds_create_qp() using peer res_domain 0x2adecc0 for QP
[48795] GDS WARN  gds_create_qp() using peer res_domain 0x2adecc0 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.017045 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (0.364000 seconds)
  estimating  lambda_max... <2.223327414050826e+00

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002762 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001181 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000125 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000112 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000681 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000136 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000614 seconds)
  Building MPI subcommunicator for level 2... done (0.000042 seconds)
  Building MPI subcommunicator for level 3... done (0.000043 seconds)
  Building MPI subcommunicator for level 4... done (0.000029 seconds)
  Building MPI subcommunicator for level 5... done (0.000030 seconds)
  Building MPI subcommunicator for level 6... done (0.000028 seconds)

  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.029289 seconds)
  estimating  lambda_max... <2.223343744583414e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012236 seconds)
  estimating  lambda_max... <2.223470419163302e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010815 seconds)
  estimating  lambda_max... <2.224369200200337e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003329 seconds)
  estimating  lambda_max... <2.228709356167994e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002577 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000054 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.058255 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039890 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039228 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043265 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038954 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039313 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042954 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039486 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042760 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040342 seconds)

WARMUP TIME: 0.425228


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039037 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041486 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041319 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042761 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043427 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038189 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040968 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038267 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040953 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040902 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039580 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039903 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042898 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041325 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039926 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037126 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042360 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039841 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040423 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038590 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041931 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041278 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042443 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041453 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040890 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039800 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041592 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039012 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039545 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039736 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038633 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041924 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040795 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041025 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040225 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042527 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039147 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040107 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039947 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039504 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041323 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040580 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041507 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041686 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042453 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040306 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039030 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039982 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040866 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042352 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043107 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039137 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039802 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040213 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039201 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042646 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040493 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037501 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041254 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043072 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044961 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041270 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040578 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041267 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039795 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041054 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039437 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039437 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040542 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041311 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039227 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040586 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041933 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038547 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040840 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041375 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040021 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039903 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040498 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041879 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040635 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040330 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039541 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041050 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040615 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041388 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040998 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039705 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039090 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042359 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040963 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040995 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038876 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040770 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041029 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039961 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040687 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039360 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042312 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039431 seconds)

EXEC_TIME TIME: 4.069150


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000049     0.000099     0.000147     0.002776     0.000568     0.000144     0.000000     0.003782
residual                      0.000008     0.000009     0.000013     0.000374     0.000067     0.000017     0.000007     0.000494
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000033     0.000033
BLAS1                         0.008103     0.000004     0.000008     0.000024     0.000011     0.000011     0.000027     0.008187
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000112     0.000226     0.000336     0.000532     0.000293     0.000208     0.000040     0.001747
Restriction                   0.000011     0.000014     0.012127     0.000020     0.000098     0.000098     0.000000     0.012369
  local restriction           0.000010     0.000013     0.000438     0.000018     0.000005     0.000003     0.000000     0.000488
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000010     0.000013     0.000000     0.000024
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000080     0.000077     0.000000     0.000157
Interpolation                 0.000174     0.000260     0.000455     0.000263     0.000142     0.001733     0.000000     0.003027
  local interpolation         0.000009     0.000014     0.000268     0.000101     0.000017     0.000005     0.000000     0.000414
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000005     0.000009     0.000000     0.000014
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000016     0.000013     0.000000     0.000030
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000010     0.001695     0.000000     0.001706
Ghost Zone Exchange           0.001119     0.002171     0.003270     0.001799     0.001954     0.001008     0.000004     0.011324
  local exchange              0.000060     0.000116     0.000183     0.000218     0.000088     0.000073     0.000000     0.000737
  pack MPI buffers            0.000061     0.000121     0.000187     0.000157     0.000078     0.000058     0.000000     0.000663
  unpack MPI buffers          0.000056     0.000109     0.000167     0.000208     0.000104     0.000071     0.000000     0.000716
  MPI_Isend                   0.000281     0.000590     0.000921     0.000322     0.001031     0.000333     0.000000     0.003478
  MPI_Irecv                   0.000248     0.000490     0.000766     0.000197     0.000214     0.000144     0.000000     0.002061
  MPI_Waitall                 0.000182     0.000366     0.000562     0.000673     0.000412     0.000300     0.000000     0.002494
MPI_collectives               0.000291     0.000000     0.000000     0.000000     0.000000     0.000000     0.000161     0.000453
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000001
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.009809     0.002636     0.016145     0.005603     0.002987     0.003134     0.000285     0.040597

   Total time in MGBuild      0.125403 seconds
   Total time in MGSolve      0.040614 seconds
      number of v-cycles             1
Bottom solver iterations            23




===== Performance Summary ======================================================
  h=5.208333333333333e-03  DOF=7.077888000000000e+06  time=0.040614  DOF/s=1.743e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040604 seconds)
  h=5.208333333333333e-03  ||error||=3.098963575494077e-03
  order=-19.412


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 6 8
[hsw218:48809] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[23750] [1] MP INFO mp_init() using IB device: mlx5_0 
[23750] [1] MP INFO mp_init() HCA dev: mlx5_0
[23193] [3] MP INFO mp_init() using IB device: mlx5_0 
[23193] [3] MP INFO mp_init() HCA dev: mlx5_0
[21773] [2] MP INFO mp_init() using IB device: mlx5_0 
[21773] [2] MP INFO mp_init() HCA dev: mlx5_0
[23750] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2945b0 for QP
[23750] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2945b0 for QP
[23193] GDS WARN  gds_create_qp() using peer res_domain 0xf98190 for QP
[23193] GDS WARN  gds_create_qp() using peer res_domain 0xf98190 for QP
[48836] [0] MP INFO mp_init() using IB device: mlx5_0 
[48836] [0] MP INFO mp_init() HCA dev: mlx5_0
[21773] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6e40 for QP
[21773] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2c6e40 for QP
[23750] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcd70 for QP
[23750] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcd70 for QP
[23193] GDS WARN  gds_create_qp() using peer res_domain 0x2ab3e40 for QP
[23193] GDS WARN  gds_create_qp() using peer res_domain 0x2ab3e40 for QP
[48836] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494910 for QP
[48836] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494910 for QP
[21773] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ced540 for QP
[21773] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ced540 for QP
[23750] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6d10 for QP
[23750] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6d10 for QP
[23193] GDS WARN  gds_create_qp() using peer res_domain 0x2adde20 for QP
[23193] GDS WARN  gds_create_qp() using peer res_domain 0x2adde20 for QP
[48836] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbebd0 for QP
[48836] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbebd0 for QP
[21773] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe519560 for QP
[21773] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe519560 for QP
[48836] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe8b80 for QP
[48836] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe8b80 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.017494 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (0.418443 seconds)
  estimating  lambda_max... <2.223327414050826e+00

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002846 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001205 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000264 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000145 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000674 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000208 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000547 seconds)
  Building MPI subcommunicator for level 2... done (0.000036 seconds)
  Building MPI subcommunicator for level 3... done (0.000042 seconds)
  Building MPI subcommunicator for level 4... done (0.000029 seconds)
  Building MPI subcommunicator for level 5... done (0.000031 seconds)
  Building MPI subcommunicator for level 6... done (0.000029 seconds)

  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.029285 seconds)
  estimating  lambda_max... <2.223343744583414e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012076 seconds)
  estimating  lambda_max... <2.223470419163302e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011312 seconds)
  estimating  lambda_max... <2.224369200200337e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003319 seconds)
  estimating  lambda_max... <2.228709356167994e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002408 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.055849 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038052 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037935 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041297 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039718 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040374 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040938 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039974 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038910 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040171 seconds)

WARMUP TIME: 0.413950


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038170 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041629 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041863 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042035 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040207 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039363 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039189 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040658 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038826 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039386 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039721 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039206 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041060 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040399 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039149 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039771 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040931 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038383 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040754 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038535 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040417 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040512 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038289 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040897 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041743 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038980 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039127 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046049 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045477 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046269 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049761 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045424 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045471 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046653 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045325 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044876 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044965 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045923 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047401 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046370 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047780 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049261 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.051244 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048539 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047273 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045108 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045810 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044722 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044536 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047055 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046261 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046744 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049817 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045844 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047481 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045943 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045305 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045122 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046912 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.050125 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047888 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047057 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045741 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.051065 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045426 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049199 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048011 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046512 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045611 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048198 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048566 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048018 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048026 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047912 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049594 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044292 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044727 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046400 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046567 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046449 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047371 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045825 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046146 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044770 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046139 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045456 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049555 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046335 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046803 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048339 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048733 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048581 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045753 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044407 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047201 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044488 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046701 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048499 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045808 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047583 seconds)

EXEC_TIME TIME: 4.507194


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000049     0.000097     0.000143     0.002715     0.000571     0.000144     0.000000     0.003719
residual                      0.000009     0.000009     0.000013     0.000366     0.000067     0.000017     0.000008     0.000488
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000033     0.000033
BLAS1                         0.008099     0.000004     0.000007     0.000024     0.000011     0.000010     0.000027     0.008182
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000117     0.000228     0.000344     0.000502     0.000281     0.000187     0.000038     0.001697
Restriction                   0.000011     0.000014     0.012074     0.000021     0.000073     0.000079     0.000000     0.012273
  local restriction           0.000011     0.000014     0.000451     0.000019     0.000005     0.000002     0.000000     0.000501
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000001     0.000002     0.000000     0.000003
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000011     0.000014     0.000000     0.000024
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000055     0.000058     0.000000     0.000113
Interpolation                 0.000174     0.000265     0.000497     0.000219     0.000191     0.000610     0.000000     0.001955
  local interpolation         0.000009     0.000014     0.000271     0.000099     0.000017     0.000005     0.000000     0.000415
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000005     0.000008     0.000000     0.000013
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000020     0.000014     0.000000     0.000034
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000037     0.000574     0.000000     0.000610
Ghost Zone Exchange           0.001141     0.002206     0.003338     0.002301     0.001762     0.001328     0.000004     0.012079
  local exchange              0.000061     0.000122     0.000184     0.000204     0.000094     0.000063     0.000000     0.000727
  pack MPI buffers            0.000063     0.000120     0.000189     0.000147     0.000066     0.000056     0.000000     0.000642
  unpack MPI buffers          0.000056     0.000110     0.000168     0.000195     0.000102     0.000063     0.000000     0.000695
  MPI_Isend                   0.000291     0.000607     0.000959     0.000472     0.000885     0.000668     0.000000     0.003882
  MPI_Irecv                   0.000254     0.000500     0.000783     0.000195     0.000217     0.000149     0.000000     0.002099
  MPI_Waitall                 0.000184     0.000370     0.000570     0.001063     0.000369     0.000298     0.000000     0.002854
MPI_collectives               0.005224     0.000000     0.000000     0.000000     0.000000     0.000000     0.000164     0.005388
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000001
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.014764     0.002676     0.016202     0.005922     0.002851     0.002273     0.000288     0.044976

   Total time in MGBuild      0.125266 seconds
   Total time in MGSolve      0.044993 seconds
      number of v-cycles             1
Bottom solver iterations            23




===== Performance Summary ======================================================
  h=5.208333333333333e-03  DOF=7.077888000000000e+06  time=0.044993  DOF/s=1.573e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044395 seconds)
  h=5.208333333333333e-03  ||error||=3.098963575494077e-03
  order=-19.412


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 6 8
[hsw218:48857] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[23229] [3] MP INFO mp_init() using IB device: mlx5_0 
[23229] [3] MP INFO mp_init() HCA dev: mlx5_0
[23779] [1] MP INFO mp_init() using IB device: mlx5_0 
[23779] [1] MP INFO mp_init() HCA dev: mlx5_0
[21802] [2] MP INFO mp_init() using IB device: mlx5_0 
[21802] [2] MP INFO mp_init() HCA dev: mlx5_0
[23229] GDS WARN  gds_create_qp() using peer res_domain 0xf98670 for QP
[23229] GDS WARN  gds_create_qp() using peer res_domain 0xf98670 for QP
[48884] [0] MP INFO mp_init() using IB device: mlx5_0 
[48884] [0] MP INFO mp_init() HCA dev: mlx5_0
[23779] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe295470 for QP
[23779] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe295470 for QP
[23229] GDS WARN  gds_create_qp() using peer res_domain 0x2ab4aa0 for QP
[23229] GDS WARN  gds_create_qp() using peer res_domain 0x2ab4aa0 for QP
[23779] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcbc0 for QP
[23779] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbcbc0 for QP
[21802] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe295070 for QP
[21802] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe295070 for QP
[48884] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294a50 for QP
[48884] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe294a50 for QP
[23779] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6ba0 for QP
[23779] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6ba0 for QP
[23229] GDS WARN  gds_create_qp() using peer res_domain 0x2adea50 for QP
[23229] GDS WARN  gds_create_qp() using peer res_domain 0x2adea50 for QP
[21802] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cb97a0 for QP
[21802] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cb97a0 for QP
[48884] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbf510 for QP
[48884] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbf510 for QP
[21802] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce3750 for QP
[21802] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce3750 for QP
[48884] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce9450 for QP
[48884] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce9450 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.018470 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (0.369428 seconds)
  estimating  lambda_max... <2.223327414050826e+00

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.003209 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000881 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000195 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000143 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000686 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000134 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000549 seconds)
  Building MPI subcommunicator for level 2... done (0.000036 seconds)
  Building MPI subcommunicator for level 3... done (0.000042 seconds)
  Building MPI subcommunicator for level 4... done (0.000028 seconds)
  Building MPI subcommunicator for level 5... done (0.000030 seconds)
  Building MPI subcommunicator for level 6... done (0.000033 seconds)

  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.029395 seconds)
  estimating  lambda_max... <2.223343744583414e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012543 seconds)
  estimating  lambda_max... <2.223470419163302e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.010989 seconds)
  estimating  lambda_max... <2.224369200200337e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003351 seconds)
  estimating  lambda_max... <2.228709356167994e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002445 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.055994 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039699 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039138 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040531 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039196 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038464 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039303 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039374 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040479 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039411 seconds)

WARMUP TIME: 0.412390


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038495 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038385 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041773 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039676 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040039 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037531 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040208 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040171 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039164 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039505 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039431 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041294 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042246 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041590 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043333 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038026 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038356 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039698 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038292 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039684 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039594 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038800 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040859 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040939 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039981 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039516 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046676 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046721 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045152 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046389 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045433 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045089 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045456 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044540 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045930 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048022 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046247 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046259 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044747 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047214 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046034 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048505 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044906 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048053 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046544 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045949 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047327 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046542 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046604 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045367 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047261 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047819 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046658 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045753 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045656 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046893 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044762 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044699 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046378 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046484 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045429 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048570 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046849 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045410 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046623 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045641 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046080 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047747 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046062 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046727 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047753 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046714 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049419 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047633 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045041 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046734 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045179 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044066 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049509 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047728 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049153 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046710 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044032 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044714 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044259 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049135 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046576 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046030 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047424 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046326 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046413 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046605 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046423 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044729 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045480 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046130 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046323 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046935 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.050519 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045973 seconds)

EXEC_TIME TIME: 4.480962


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000098     0.000144     0.002712     0.000572     0.000144     0.000000     0.003718
residual                      0.000008     0.000009     0.000012     0.000366     0.000067     0.000017     0.000007     0.000487
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000033     0.000033
BLAS1                         0.008112     0.000004     0.000007     0.000024     0.000011     0.000011     0.000028     0.008196
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000113     0.000226     0.000336     0.000503     0.000275     0.000184     0.000038     0.001675
Restriction                   0.000011     0.000014     0.012184     0.000021     0.000119     0.000067     0.000000     0.012416
  local restriction           0.000011     0.000013     0.000445     0.000019     0.000005     0.000003     0.000000     0.000495
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000001     0.000002     0.000000     0.000003
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000010     0.000014     0.000000     0.000024
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000101     0.000046     0.000000     0.000147
Interpolation                 0.000173     0.000261     0.000474     0.000260     0.000243     0.000755     0.000000     0.002166
  local interpolation         0.000010     0.000015     0.000268     0.000099     0.000018     0.000005     0.000000     0.000413
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000005     0.000008     0.000000     0.000013
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000020     0.000014     0.000000     0.000033
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000116     0.000718     0.000000     0.000834
Ghost Zone Exchange           0.001120     0.002182     0.003271     0.002097     0.001424     0.001351     0.000004     0.011448
  local exchange              0.000060     0.000117     0.000177     0.000202     0.000096     0.000063     0.000000     0.000715
  pack MPI buffers            0.000061     0.000119     0.000184     0.000147     0.000066     0.000054     0.000000     0.000632
  unpack MPI buffers          0.000056     0.000111     0.000168     0.000195     0.000103     0.000063     0.000000     0.000695
  MPI_Isend                   0.000285     0.000597     0.000927     0.000343     0.000565     0.000676     0.000000     0.003392
  MPI_Irecv                   0.000248     0.000491     0.000763     0.000193     0.000214     0.000147     0.000000     0.002056
  MPI_Waitall                 0.000183     0.000368     0.000565     0.000992     0.000351     0.000320     0.000000     0.002780
MPI_collectives               0.005233     0.000000     0.000000     0.000000     0.000000     0.000000     0.000169     0.005403
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000001
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.014758     0.002647     0.016219     0.005777     0.002565     0.002453     0.000294     0.044712

   Total time in MGBuild      0.126026 seconds
   Total time in MGSolve      0.044730 seconds
      number of v-cycles             1
Bottom solver iterations            23




===== Performance Summary ======================================================
  h=5.208333333333333e-03  DOF=7.077888000000000e+06  time=0.044730  DOF/s=1.582e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048560 seconds)
  h=5.208333333333333e-03  ||error||=3.098963575494077e-03
  order=-19.412


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 6 8
[hsw218:48898] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 1:  Number of visible GPUs:  4
rank 3:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[23816] [1] MP INFO mp_init() using IB device: mlx5_0 
[23816] [1] MP INFO mp_init() HCA dev: mlx5_0
[23258] [3] MP INFO mp_init() using IB device: mlx5_0 
[23258] [3] MP INFO mp_init() HCA dev: mlx5_0
[21832] [2] MP INFO mp_init() using IB device: mlx5_0 
[21832] [2] MP INFO mp_init() HCA dev: mlx5_0
[23816] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe0cf1f0 for QP
[23816] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe0cf1f0 for QP
[23258] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2a1f10 for QP
[23258] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2a1f10 for QP
[48925] [0] MP INFO mp_init() using IB device: mlx5_0 
[48925] [0] MP INFO mp_init() HCA dev: mlx5_0
[21832] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2a3970 for QP
[21832] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe2a3970 for QP
[23816] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4bf0970 for QP
[23816] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4bf0970 for QP
[23258] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc7270 for QP
[23258] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc7270 for QP
[48925] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe287720 for QP
[48925] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe287720 for QP
[21832] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc70f0 for QP
[21832] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cc70f0 for QP
[23816] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe329960 for QP
[23816] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe329960 for QP
[23258] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf1210 for QP
[23258] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf1210 for QP
[48925] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4caeeb0 for QP
[48925] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4caeeb0 for QP
[21832] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf1090 for QP
[21832] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cf1090 for QP
[48925] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cd8e50 for QP
[48925] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cd8e50 for QP


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
  Allocating vectors... WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications
done
  Duplicating MPI_COMM_WORLD... done (0.018406 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (0.362170 seconds)
  estimating  lambda_max... <2.223327414050826e+00

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.002938 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001189 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000208 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000155 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000698 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000138 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000595 seconds)
  Building MPI subcommunicator for level 2... done (0.000037 seconds)
  Building MPI subcommunicator for level 3... done (0.000044 seconds)
  Building MPI subcommunicator for level 4... done (0.000034 seconds)
  Building MPI subcommunicator for level 5... done (0.000032 seconds)
  Building MPI subcommunicator for level 6... done (0.000032 seconds)

  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.029517 seconds)
  estimating  lambda_max... <2.223343744583414e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012374 seconds)
  estimating  lambda_max... <2.223470419163302e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.011358 seconds)
  estimating  lambda_max... <2.224369200200337e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003460 seconds)
  estimating  lambda_max... <2.228709356167994e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002490 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000058 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.055324 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039915 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041568 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044369 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042497 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039238 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038934 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039863 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041616 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041443 seconds)

WARMUP TIME: 0.425522


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040191 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041403 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041920 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040505 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042371 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039038 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041632 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040085 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040308 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043179 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040408 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042088 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041741 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040003 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039433 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038304 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041950 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039964 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040098 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038421 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040230 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042332 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041359 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041055 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040590 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039311 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039000 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041800 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040947 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038538 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040525 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044311 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038372 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041449 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043209 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041043 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040250 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038998 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040972 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039544 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041156 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040722 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042036 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042700 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038985 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040321 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040279 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039961 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039226 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041783 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042160 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039379 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040536 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038974 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040467 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042171 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039572 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038133 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040679 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041333 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039990 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040396 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039352 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038108 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040392 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038333 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038530 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039302 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041619 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039837 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038929 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042933 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043339 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039917 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038916 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039932 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041233 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042355 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039424 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040234 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044409 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040857 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040572 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039511 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038914 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040350 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039865 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040369 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038813 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040909 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039195 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040052 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039670 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039877 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039996 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040849 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039943 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042522 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039964 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040840 seconds)

EXEC_TIME TIME: 4.055354


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000049     0.000100     0.000143     0.002777     0.000527     0.000146     0.000000     0.003743
residual                      0.000009     0.000009     0.000013     0.000373     0.000064     0.000017     0.000007     0.000492
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000032     0.000032
BLAS1                         0.008118     0.000004     0.000007     0.000024     0.000010     0.000011     0.000026     0.008200
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000112     0.000225     0.000334     0.000531     0.000282     0.000214     0.000040     0.001739
Restriction                   0.000011     0.000015     0.012135     0.000019     0.000328     0.000085     0.000000     0.012594
  local restriction           0.000011     0.000014     0.000441     0.000018     0.000005     0.000003     0.000000     0.000491
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000001     0.000003     0.000000     0.000004
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000010     0.000014     0.000000     0.000024
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000310     0.000064     0.000000     0.000374
Interpolation                 0.000175     0.000263     0.000456     0.000242     0.000160     0.001607     0.000000     0.002903
  local interpolation         0.000010     0.000014     0.000262     0.000101     0.000017     0.000005     0.000000     0.000409
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000005     0.000009     0.000000     0.000014
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000023     0.000013     0.000000     0.000036
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000017     0.001568     0.000000     0.001585
Ghost Zone Exchange           0.001124     0.002186     0.003280     0.001910     0.001779     0.000908     0.000004     0.011191
  local exchange              0.000060     0.000118     0.000182     0.000216     0.000073     0.000072     0.000000     0.000721
  pack MPI buffers            0.000062     0.000120     0.000187     0.000156     0.000076     0.000062     0.000000     0.000663
  unpack MPI buffers          0.000056     0.000112     0.000169     0.000209     0.000085     0.000070     0.000000     0.000702
  MPI_Isend                   0.000287     0.000598     0.000933     0.000426     0.000897     0.000243     0.000000     0.003383
  MPI_Irecv                   0.000246     0.000489     0.000764     0.000196     0.000214     0.000151     0.000000     0.002061
  MPI_Waitall                 0.000182     0.000366     0.000558     0.000681     0.000405     0.000282     0.000000     0.002475
MPI_collectives               0.000209     0.000000     0.000000     0.000000     0.000000     0.000000     0.000168     0.000377
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000001
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.009748     0.002652     0.016156     0.005685     0.003026     0.002900     0.000290     0.040458

   Total time in MGBuild      0.126813 seconds
   Total time in MGSolve      0.040475 seconds
      number of v-cycles             1
Bottom solver iterations            23




===== Performance Summary ======================================================
  h=5.208333333333333e-03  DOF=7.077888000000000e+06  time=0.040475  DOF/s=1.749e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041312 seconds)
  h=5.208333333333333e-03  ||error||=3.098963575494077e-03
  order=-19.412


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0


===========================================================================

./run.sh 4 1 1 0 6 8
[hsw218:48939] Warning: could not find environment variable "MP_ENABLE_WARN"

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0


# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0

# psgcluster, Local Rank 0, GPU:/3 CPU:1 HCA:mlx5_0
rank 3:  Number of visible GPUs:  4
rank 1:  Number of visible GPUs:  4
rank 2:  Number of visible GPUs:  4
rank 0:  Number of visible GPUs:  4
rank 3:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 1:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 2:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
rank 0:  Selecting device 3 (Tesla P100-PCIE-16GB)
WARNING: enabling Comm-based communications
[23845] [1] MP INFO mp_init() using IB device: mlx5_0 
[23845] [1] MP INFO mp_init() HCA dev: mlx5_0
[23287] [3] MP INFO mp_init() using IB device: mlx5_0 
[23287] [3] MP INFO mp_init() HCA dev: mlx5_0
[21868] [2] MP INFO mp_init() using IB device: mlx5_0 
[21868] [2] MP INFO mp_init() HCA dev: mlx5_0
[23845] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494a50 for QP
[23845] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494a50 for QP
[23287] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe0ebfb0 for QP
[23287] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe0ebfb0 for QP
[21868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe298770 for QP
[21868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe298770 for QP
[23845] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbcdb0 for QP
[23845] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbcdb0 for QP
[23287] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe317780 for QP
[23287] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe317780 for QP
[21868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbce50 for QP
[21868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4cbce50 for QP
[23845] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe6d50 for QP
[23845] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe6d50 for QP
[23287] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe341760 for QP
[23287] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe341760 for QP
[48966] [0] MP INFO mp_init() using IB device: mlx5_0 
[48966] [0] MP INFO mp_init() HCA dev: mlx5_0
[21868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6e00 for QP
[21868] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4ce6e00 for QP
[48966] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494750 for QP
[48966] GDS WARN  gds_create_qp() using peer res_domain 0x2aaabe494750 for QP
[48966] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbca40 for QP
[48966] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fbca40 for QP
[48966] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe6a20 for QP
[48966] GDS WARN  gds_create_qp() using peer res_domain 0x2aaae4fe6a20 for QP
WARNING: enabling GPUDirect Async for communications
WARNING: enabling GPUDirect Async for communications


********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_SINGLE, got MPI_THREAD_SINGLE
4 MPI Tasks of 1 threads


===== Benchmark setup ==========================================================

attempting to create a 192^3 level from 27 x 64^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
WARNING: enabling GPUDirect Async for communications
  This level will be run on the GPU
WARNING: enabling GPUDirect Async for communications
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.017125 seconds)
  Calculating boxes per process... target=6.750, max=7
  Creating Poisson (a=0.000000, b=1.000000) test problem
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
  calculating D^{-1} exactly for level h=5.208333e-03 using 64 colors...  WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
WARNING: disabling GPU-initiated communications
HPGMG_ENABLE_DEBUG=0
done (0.358495 seconds)
  estimating  lambda_max... <2.223327414050826e+00

attempting to create a 96^3 level from 27 x 32^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.003051 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 48^3 level from 27 x 16^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the GPU
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.001109 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 24^3 level from 27 x 8^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000092 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 12^3 level from 27 x 4^3 boxes distributed among 4 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000125 seconds)
  Calculating boxes per process... target=6.750, max=7

attempting to create a 6^3 level from 27 x 2^3 boxes distributed among 3 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000686 seconds)
  Calculating boxes per process... target=9.000, max=9

attempting to create a 3^3 level from 1 x 3^3 boxes distributed among 1 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  This level will be run on the host
  Allocating vectors... done
  Duplicating MPI_COMM_WORLD... done (0.000130 seconds)
  Calculating boxes per process... target=1.000, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level 1... done (0.000558 seconds)
  Building MPI subcommunicator for level 2... done (0.000039 seconds)
  Building MPI subcommunicator for level 3... done (0.000045 seconds)
  Building MPI subcommunicator for level 4... done (0.000030 seconds)
  Building MPI subcommunicator for level 5... done (0.000031 seconds)
  Building MPI subcommunicator for level 6... done (0.000030 seconds)

  calculating D^{-1} exactly for level h=1.041667e-02 using 64 colors...  done (0.029141 seconds)
  estimating  lambda_max... <2.223343744583414e+00
  calculating D^{-1} exactly for level h=2.083333e-02 using 64 colors...  done (0.012543 seconds)
  estimating  lambda_max... <2.223470419163302e+00
  calculating D^{-1} exactly for level h=4.166667e-02 using 64 colors...  done (0.012020 seconds)
  estimating  lambda_max... <2.224369200200337e+00
  calculating D^{-1} exactly for level h=8.333333e-02 using 64 colors...  done (0.003382 seconds)
  estimating  lambda_max... <2.228709356167994e+00
  calculating D^{-1} exactly for level h=1.666667e-01 using 64 colors...  done (0.002464 seconds)
  estimating  lambda_max... <2.163934426229508e+00
  calculating D^{-1} exactly for level h=3.333333e-01 using 27 colors...  done (0.000053 seconds)
  estimating  lambda_max... <2.193548387096774e+00



===== Warming up by running 10 solves ==========================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.056113 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039278 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039299 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038753 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039893 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038428 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038174 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040725 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040277 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040849 seconds)

WARMUP TIME: 0.412496


===== Running 100 solves ========================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038147 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039911 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040955 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038785 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041677 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041531 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038922 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040039 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037933 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039021 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040763 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039154 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.042089 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038545 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040807 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043272 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040144 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.038860 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039346 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037894 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039129 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.041355 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.039844 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.040057 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.037712 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046651 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043598 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048564 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044584 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044067 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045698 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047158 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045894 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046349 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046944 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046441 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045996 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046763 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045025 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045287 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045155 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048418 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046974 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046740 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047136 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044181 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045734 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045421 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046956 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046259 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047977 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046502 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046492 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045052 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044774 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048401 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044962 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045256 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046543 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044342 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048847 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045602 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048019 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043823 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045627 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047117 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047578 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046889 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047806 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049070 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045254 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.049283 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046320 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043782 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044708 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047576 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047025 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047582 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045389 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047772 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048633 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047543 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044328 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044972 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047741 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045070 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.044687 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045945 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046057 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046330 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047566 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046088 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046932 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.043977 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046748 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047289 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.048876 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046124 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.045791 seconds)
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.047835 seconds)

EXEC_TIME TIME: 4.479022


===== Timing Breakdown =========================================================


level                                0              1              2              3              4              5              6   
level dimension                  192^3         96^3         48^3         24^3         12^3          6^3          3^3 
use cuda                           1            1            1            0            0            0            0   
box dimension                     64^3         32^3         16^3          8^3          4^3          2^3          3^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.000048     0.000098     0.000143     0.002725     0.000514     0.000132     0.000000     0.003659
residual                      0.000008     0.000008     0.000012     0.000367     0.000066     0.000016     0.000008     0.000486
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000033     0.000033
BLAS1                         0.008092     0.000004     0.000007     0.000024     0.000010     0.000008     0.000027     0.008172
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.000114     0.000231     0.000338     0.000502     0.000257     0.000179     0.000037     0.001658
Restriction                   0.000011     0.000015     0.012099     0.000020     0.000099     0.000065     0.000000     0.012310
  local restriction           0.000010     0.000014     0.000450     0.000018     0.000005     0.000002     0.000000     0.000499
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000001     0.000002     0.000000     0.000003
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000010     0.000013     0.000000     0.000023
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000081     0.000046     0.000000     0.000127
Interpolation                 0.000174     0.000263     0.000446     0.000253     0.000194     0.000699     0.000000     0.002029
  local interpolation         0.000009     0.000014     0.000260     0.000098     0.000016     0.000005     0.000000     0.000402
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000005     0.000008     0.000000     0.000013
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000025     0.000014     0.000000     0.000039
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000060     0.000662     0.000000     0.000722
Ghost Zone Exchange           0.001139     0.002206     0.003305     0.002107     0.001588     0.001195     0.000004     0.011544
  local exchange              0.000060     0.000119     0.000179     0.000202     0.000062     0.000059     0.000000     0.000680
  pack MPI buffers            0.000063     0.000123     0.000190     0.000147     0.000064     0.000053     0.000000     0.000640
  unpack MPI buffers          0.000056     0.000111     0.000168     0.000194     0.000067     0.000060     0.000000     0.000656
  MPI_Isend                   0.000289     0.000606     0.000937     0.000344     0.000535     0.000504     0.000000     0.003214
  MPI_Irecv                   0.000256     0.000502     0.000783     0.000197     0.000213     0.000142     0.000000     0.002092
  MPI_Waitall                 0.000183     0.000366     0.000564     0.000998     0.000619     0.000348     0.000000     0.003079
MPI_collectives               0.005450     0.000000     0.000000     0.000000     0.000000     0.000000     0.000163     0.005613
AsyncTimer                    0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000001
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                0.014979     0.002677     0.016139     0.005811     0.002586     0.002218     0.000286     0.044696

   Total time in MGBuild      0.127257 seconds
   Total time in MGSolve      0.044713 seconds
      number of v-cycles             1
Bottom solver iterations            23




===== Performance Summary ======================================================
  h=5.208333333333333e-03  DOF=7.077888000000000e+06  time=0.044713  DOF/s=1.583e+08  MPI=4  OMP=1  ACC=1


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=1.613954755050329e-06  rel=1.620014041204685e-06  done (0.046971 seconds)
  h=5.208333333333333e-03  ||error||=3.098963575494077e-03
  order=-19.412


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     3^3 level... done
attempting to free the     6^3 level... done
attempting to free the    12^3 level... done
attempting to free the    24^3 level... done
attempting to free the    48^3 level... done
attempting to free the    96^3 level... done
attempting to free the   192^3 level... done


===== Done =====================================================================
Use LibMP=1
Use GPUDirect Async, SA model=1
Use GPUDirect Async, KI model=0
